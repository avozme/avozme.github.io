I"4A<h2 class="no_toc" id="53-instalación-de-laravel">5.3. Instalación de Laravel</h2>

<ul id="markdown-toc">
  <li><a href="#531-instalación-nativa-en-servidor-local" id="markdown-toc-531-instalación-nativa-en-servidor-local">5.3.1. Instalación nativa en servidor local</a>    <ul>
      <li><a href="#paso-1" id="markdown-toc-paso-1"><strong>Paso 1</strong></a></li>
      <li><a href="#paso-2" id="markdown-toc-paso-2"><strong>Paso 2</strong></a></li>
      <li><a href="#paso-3" id="markdown-toc-paso-3"><strong>Paso 3</strong></a></li>
      <li><a href="#problemas-frecuentes" id="markdown-toc-problemas-frecuentes">Problemas frecuentes</a></li>
    </ul>
  </li>
  <li><a href="#532-instalación-de-laravel-con-máquina-virtual-vagrant-homestead" id="markdown-toc-532-instalación-de-laravel-con-máquina-virtual-vagrant-homestead">5.3.2. Instalación de Laravel con máquina virtual Vagrant (Homestead)</a>    <ul>
      <li><a href="#paso-1-1" id="markdown-toc-paso-1-1"><strong>Paso 1</strong></a></li>
      <li><a href="#paso-2-1" id="markdown-toc-paso-2-1"><strong>Paso 2</strong></a></li>
      <li><a href="#paso-3-1" id="markdown-toc-paso-3-1"><strong>Paso 3</strong></a></li>
      <li><a href="#paso-4" id="markdown-toc-paso-4"><strong>Paso 4</strong></a></li>
      <li><a href="#paso-5" id="markdown-toc-paso-5"><strong>Paso 5</strong></a></li>
      <li><a href="#paso-6" id="markdown-toc-paso-6"><strong>Paso 6</strong></a></li>
      <li><a href="#paso-7" id="markdown-toc-paso-7"><strong>Paso 7</strong></a></li>
      <li><a href="#paso-8" id="markdown-toc-paso-8"><strong>Paso 8</strong></a></li>
      <li><a href="#paso-9" id="markdown-toc-paso-9"><strong>Paso 9</strong></a></li>
      <li><a href="#paso-10" id="markdown-toc-paso-10"><strong>Paso 10</strong></a></li>
      <li><a href="#paso-11" id="markdown-toc-paso-11"><strong>Paso 11</strong></a></li>
      <li><a href="#paso-12" id="markdown-toc-paso-12"><strong>Paso 12</strong></a></li>
    </ul>
  </li>
  <li><a href="#533-laravel-con-docker" id="markdown-toc-533-laravel-con-docker">5.3.3. Laravel con Docker</a>    <ul>
      <li><a href="#paso-1-2" id="markdown-toc-paso-1-2"><strong>Paso 1</strong></a></li>
      <li><a href="#paso-2-2" id="markdown-toc-paso-2-2"><strong>Paso 2</strong></a></li>
      <li><a href="#paso-3-2" id="markdown-toc-paso-3-2"><strong>Paso 3</strong></a></li>
      <li><a href="#paso-4-1" id="markdown-toc-paso-4-1"><strong>Paso 4</strong></a></li>
      <li><a href="#paso-5-1" id="markdown-toc-paso-5-1"><strong>Paso 5</strong></a></li>
    </ul>
  </li>
</ul>

<p>En esta sección vamos a describir el proceso de instalación de Laravel en un servidor local para desarrollo.</p>

<p>Hay, básicamente, tres posibilidades:</p>

<ol>
  <li><strong>Usar un servidor Apache (o similar) local y configurarlo adecuadamente</strong> para que Laravel funcione.</li>
  <li><strong>Usar un servidor virtualizado mediante Vagrant</strong>.</li>
  <li><strong>Usar un servidor virtualizado mediante Docker</strong>.</li>
</ol>

<p>Vagrant y Docker son dos soluciones de virtualización muy utilizadas últimamente. La virtualización es un campo fascinante y en la cresta de la ola. Lamentablemente, aquí no tenemos ni tiempo ni espacio para hablarte largo y tendido sobre ello, por lo que nos limitaremos a explicarte los pasos que debes seguir para montar tu servidor virtualizado y ponerte a trabajar con Laravel, sin entrar en otros detalles.</p>

<p>Si quieres aprender más sobre Vagrant: <a href="https://www.vagrantup.com/docs">https://www.vagrantup.com/docs</a></p>

<p>Si quieres aprender más sobre Docker: <a href="https://docs.docker.com/">https://docs.docker.com/</a></p>

<h3 id="531-instalación-nativa-en-servidor-local">5.3.1. Instalación nativa en servidor local</h3>

<p><strong>No es recomendable instalar Laravel de forma nativa en tu servidor local</strong> porque requiere una fuerte configuración del servidor. Tendrás que instalar bastante librerías que consumirán recursos de tu máquina sin necesidad, tales como OpenSSL, Mbstring o Tokenizer.</p>

<p>También necesitarás instalar composer, la herramienta de resolución de dependencias de PHP.</p>

<p>Por todo ello, los desarrolladores de Laravel aconsejan <strong>virtualizar el servidor</strong>.</p>

<p>Esto lo podemos hacer mediante <strong>Vagrant</strong> o <strong>Docker</strong>. Discutiremos estas dos opciones más adelante.</p>

<p>Si, aún así, estás decidido a instalar Laravel de forma nativa en tu servidor local, sigue estos pasos:</p>

<h4 id="paso-1"><strong>Paso 1</strong></h4>

<p>Instala todo el software de servidor necesario para que Laravel funcione.</p>

<p>Empieza por instalar <strong>composer</strong>, la herramienta de instalación de dependencias de PHP. Después, durante la instalación de Laravel, el propio composer se encargará de instalar el resto del software necesario. Si no puede instalar algo, ya te avisará para que lo hagas tú manualmente.</p>

<h4 id="paso-2"><strong>Paso 2</strong></h4>

<p>Descarga Laravel usando composer.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ composer global require "laravel/installer"
</code></pre></div></div>

<h4 id="paso-3"><strong>Paso 3</strong></h4>

<p>Instala una copia de Laravel limpia y lista para usar (en un directorio accesible por Apache o el servidor web que estés usando, claro). Puede ser que tengas que añadir el comando <em>laravel</em> al PATH del sistema.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ laravel new &lt;nombre-aplicación&gt;
</code></pre></div></div>

<p>Por ejemplo:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ laravel new blog
</code></pre></div></div>

<p>No olvides dar los permisos necesarios a tus archivos y directorios.</p>

<h4 id="problemas-frecuentes">Problemas frecuentes</h4>

<p>Lamentablemente, la lista de posibles problemas que pueden surgir durante una instalación nativa de Laravel son tantos y tan variados, dependiendo de la configuración de tu servidor, que sería imposible dar una lista exhaustiva.</p>

<p>Te vuelvo a recordar que <em>los desarrolladores de Laravel desaconsejan instalarlo de este modo</em>, pero allá tú.</p>

<p>Si sigues empeñado/a en hacerlo, puedes intentar seguir alguna de estas guías:</p>

<ul>
  <li>
    <p><a href="https://www.howtoforge.com/tutorial/install-laravel-on-ubuntu-for-apache/">Guía para instalar Laravel en localhost en Ubuntu Linux</a></p>
  </li>
  <li>
    <p><a href="https://weeklyhow.com/installing-laravel-8-with-xampp/">Guía para instalar Laravel en localhost con Windows y XAMPP:</a></p>
  </li>
</ul>

<h3 id="532-instalación-de-laravel-con-máquina-virtual-vagrant-homestead">5.3.2. Instalación de Laravel con máquina virtual Vagrant (Homestead)</h3>

<p><strong>Vagrant</strong> es una herramienta para crear un entorno de desarrollo virtual portable sin necesidad de instalar componentes en nuestra máquina. Utiliza de forma transparente alguna otra tecnología de virtualización, como VirtualBox, VMWare, Docker o KVM.</p>

<p>Con Vagrant se pueden crear entornos de desarrollo perfectamente configurados que luego podemos replicar con un simple comando cad vez que los necesitemos. Esto agiliza mucho el proceso de configuración de nuestro servidor web.</p>

<p>Cada entorno de desarrollo configurado con Vagrant se llama <strong>Box</strong>. Hay cientos de <em>boxes</em> ya configurados que podemos usar, o podemos definir los nuestros propios.</p>

<p>Pues bien, <strong>Homestead</strong> es un Box de Vagrant con todo lo necesario para desarrollar con Laravel sin necesidad de configurar nada en nuestro servidor local. Este Box, creado por los propios desarrolladores de Laravel, puede adaptarse para equipararlo al servidor donde se vaya a desplegar la aplicación en el futuro.</p>

<p>La instalación de Laravel por medio de Homestead <strong>es la forma recomendada para desarrollar proyectos Laravel en un entorno local</strong>. La puesta en producción es otra historia, y dependerá de las posibilidades de configuración del servidor.</p>

<p>Instalar Laravel con Homestead en tu entorno local puede parecer un proceso largo y complejo, pero no suele dar problemas y la fiabilidad de está solución está garantizada, por lo que es la manera más recomendable.</p>

<p>Si deseas instalarlo, sigue estos pasos:</p>

<h4 id="paso-1-1"><strong>Paso 1</strong></h4>

<p>Instala en tu ordenador la última versión disponible de Virtual Box.</p>

<h4 id="paso-2-1"><strong>Paso 2</strong></h4>

<p>Instala también Vagrant y git (si aún no lo tenías instalado)</p>

<h4 id="paso-3-1"><strong>Paso 3</strong></h4>

<p>Agrega a Vagrant el box de Homestead con este comando:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ vagrant box add laravel/homestead
</code></pre></div></div>

<h4 id="paso-4"><strong>Paso 4</strong></h4>

<p>Consigue el último código fuente de Laravel:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone https://github.com/laravel/homestead.git ~/Homestead
</code></pre></div></div>

<h4 id="paso-5"><strong>Paso 5</strong></h4>

<p>Selecciona la rama “release” del repositorio de Laravel y lanza el script de inicialización:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd Homestead
$ git checkout release
$ bash init.sh (o init.bat en Windows)
</code></pre></div></div>

<h4 id="paso-6"><strong>Paso 6</strong></h4>

<p>Edita el archivo Homestead.yaml para configurar tu máquina virtual. Es un archivo bastante sencillo de entender. Normalmente, basta con ajustar los nombres de las carpetas.</p>

<h4 id="paso-7"><strong>Paso 7</strong></h4>

<p>Edita el archivo hosts de tu sistema (/etc/hosts en Linux o C:\Windows\System32\drivers\etc\hosts en Windows) para añadir esta línea:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>192.168.10.10 homestead.test
</code></pre></div></div>

<p>(En el archivo .yaml puedes configurar otra IP para tu máquina virtual si lo prefieres)</p>

<h4 id="paso-8"><strong>Paso 8</strong></h4>

<p>Levanta la máquina virtual Homestead:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ vagrant up
</code></pre></div></div>

<p>(Este comando hay que ejecutarlo desde el directorio Homestead)</p>

<p>La primera vez puede tardar un rato mientras crea y configura la VM.</p>

<h4 id="paso-9"><strong>Paso 9</strong></h4>

<p>Prueba en el navegador la dirección: http://homestead.test. El servidor debería responder.</p>

<h4 id="paso-10"><strong>Paso 10</strong></h4>

<p>Prueba a acceder a la VM mediante ssh con el comando:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ vagrant ssh
</code></pre></div></div>

<h4 id="paso-11"><strong>Paso 11</strong></h4>

<p>En la máquina real, crea el directorio ~/code (o el que esté configurado en el archivo Homestead.yaml).</p>

<h4 id="paso-12"><strong>Paso 12</strong></h4>

<p>En la máquina virtual, a la que te habrás conectado con <code class="language-plaintext highlighter-rouge">$ vagrant ssh</code>, ve al mismo directorio ~/code (o el que esté configurado en Homestead.yaml) y actualiza las librerías PHP con composer:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ composer create-project laravel/laravel code --prefer-dist
$ composer install
</code></pre></div></div>

<p>¡Y listo! A partir de ahora, tú trabajarás en tu directorio local ~/code y cualquier cambio que hagas se mapeará automáticamente al directorio ~/code en la VM.</p>

<p>Mantén todo el tiempo una consola abierta en la VM para ejecutar los comandos que vayas necesitando, que con Laravel serán muchos.</p>

<p>Ten en cuenta que MySQL estará escuchando en 127.0.0.1:33060 (con el user “Homestead” y la password “secret”, salvo que hayas cambiado la configuración), pero ojo: esto solo es para conexiones desde <em>fuera</em> de Homestead. Desde el punto de vista de la app, MySQL seguirá estando en localhost:3306.</p>

<p>Dependiendo de tu versión de Laravel, es posible que necesites generar una clave SSH para conexiones seguras con tu servidor virtual. Aquí tienes un par de enlaces sobre como hacerlo:</p>

<ul>
  <li>
    <p><a href="https://ekiketa.es/fallo-en-homestead-check-your-homestead-yaml-file-the-path-to-your-private-key-does-not-exist/">Cómo hacerlo en Linux</a></p>
  </li>
  <li>
    <p><a href="https://medium.com/@eaimanshoshi/i-am-going-to-write-down-step-by-step-procedure-to-setup-homestead-for-laravel-5-2-17491a423aa">Cómo hacerlo en Windows 10</a></p>
  </li>
</ul>

<p>Más información sobre el proceso de instalacion de Homestead en <a href="https://laravel.com/docs/8.X/homestead">https://laravel.com/docs/8.X/homestead</a></p>

<h3 id="533-laravel-con-docker">5.3.3. Laravel con Docker</h3>

<p><strong>Docker</strong> es una solución de virtualización aún más ligera que Vagrant. Con Docker, se virtualizan solo los servicios de software que nuestra aplicación necesita para funcionar (en lugar de la máquina completa, como haría Virtual Box, por ejemplo), y se ejecutan directamente en la máquina anfitrión.</p>

<p>Los servicios virtualizados se agrupan en conjuntos llamados <strong><em>images</em></strong>. Cuando una <em>image</em> se instancia (como quien instancia una clase en programación orientada a objetos), pasan de denominarse <strong><em>containers</em></strong>.</p>

<p>Hay <em>docker images</em> para todo lo imaginable. Puedes encontrarlas en <a href="https://hub.docker.com">https://hub.docker.com</a>. Aunque Laravel recomienda la virtualización mediante Vagrant, muchos desarrolladores optan por Docker.</p>

<p>Así que, si prefieres instalar Laravel mediante Docker para un desarrollo local, sigue estos pasos:</p>

<h4 id="paso-1-2"><strong>Paso 1</strong></h4>

<p><strong>Instala <em>docker</em></strong> y, optativamente, otra herramienta llamada <strong><em>docker-compose</em></strong>, en tu ordenador. Descárgalos de la web del desarrollador (<a href="https://docs.docker.com/get-docker/">https://docs.docker.com/get-docker/</a>) o de los repositorios oficiales de tu distribución, si estás usando GNU/Linux.</p>

<p><em>docker-compose</em> es una utilidad de Docker para instanciar simultáneamente varios contenedores configurados, por lo que no es mala idea tenerla instalada junto con Docker.</p>

<h4 id="paso-2-2"><strong>Paso 2</strong></h4>

<p><strong>Busca una <em>docker image</em></strong> para desarrollo con Laravel en <a href="https://hub.docker.com">https://hub.docker.com</a>. Por ejemplo, Bitnami (una empresa propiedad de VMWare) tiene imágenes bastante fiables. La imagen de Bitnami para Docker se denomina bitnami/docker.</p>

<h4 id="paso-3-2"><strong>Paso 3</strong></h4>

<p><strong>Crea una carpeta para almacenar el código</strong> de tu aplicación web en tu disco duro. No importa en qué parte del árbol de directorios local estés.</p>

<h4 id="paso-4-1"><strong>Paso 4</strong></h4>

<p>En la consola, teclea el comando para crear una <strong>copia local de las imágenes necesarias</strong>. En el caso de la imagen Laravel de Bitnami, el comando es:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker pull bitnami/laravel
</code></pre></div></div>

<p>El nombre de la <em>docker image</em> vendrá en la documentación de la propia imagen en https://hub.docker.com</p>

<h4 id="paso-5-1"><strong>Paso 5</strong></h4>

<p>Sigue las instrucciones para el <strong>despliegue del contenedor</strong>. El desarrollador de la <em>docker image</em> habrá documentado este proceso en https://hub.docker.com.</p>

<p>En el caso de la imagen bitnami/laravel, hay que copiar un archivo remoto mediante el comando <em>curl</em> y levantar las imágenes docker con <em>docker-compose</em>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -LO https://raw.githubusercontent.com/bitnami/bitnami-docker-laravel/master/docker-compose.yml
$ docker-compose up
</code></pre></div></div>

<p>¡Y listo! Nuestro Laravel estará funcionando con todas sus dependencias resueltas.</p>
:ET