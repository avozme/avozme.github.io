<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>9.3. Escribiendo programas en C - PROG Y 3D</title> <link rel="shortcut icon" href="/docs/prog-y-3d/_site/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/prog-y-3d/_site/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/docs/prog-y-3d/_site/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/prog-y-3d/_site/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>9.3. Escribiendo programas en C | PROG Y 3D</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="9.3. Escribiendo programas en C" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes de la asignatura “Introducción a la programación y al diseño 3D”, optativa de 2º curso de bachillerato ofertada por el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes de la asignatura “Introducción a la programación y al diseño 3D”, optativa de 2º curso de bachillerato ofertada por el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="http://localhost:4000/docs/prog-y-3d/_site/escribiendo-programas-en-c/" /> <meta property="og:url" content="http://localhost:4000/docs/prog-y-3d/_site/escribiendo-programas-en-c/" /> <meta property="og:site_name" content="PROG Y 3D" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="9.3. Escribiendo programas en C" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Apuntes de la asignatura “Introducción a la programación y al diseño 3D”, optativa de 2º curso de bachillerato ofertada por el IES Celia Viñas de Almería (España)","headline":"9.3. Escribiendo programas en C","url":"http://localhost:4000/docs/prog-y-3d/_site/escribiendo-programas-en-c/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/docs/prog-y-3d/_site/" class="site-title lh-tight"> PROG Y 3D </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/" class="nav-list-link">Introd. a la prog. y al diseño 3D</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/presentacion/" class="nav-list-link">0. Presentación de la asignatura</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/bases-de-datos/" class="nav-list-link">1. Bases de datos</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/lenguaje-sql/" class="nav-list-link">2. El lenguaje SQL</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/tecnologias-de-impresion-3d/" class="nav-list-link">3. Tecnologías de impresión 3D</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/modelado-e-impresion-3d/" class="nav-list-link">4. Modelado e impresión 3D</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/pensamiento-computacional/" class="nav-list-link">5. Pensamiento computacional</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/representacion-de-la-informacion/" class="nav-list-link">6. Representación de la información</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/introduccion-a-la-programacion/" class="nav-list-link">7. Introducción a la programación</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/estructuras-de-datos/" class="nav-list-link">8. Estructuras de datos. Subalgoritmos</a><ul class="nav-list"></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/lenguaje-c/" class="nav-list-link">9. El lenguaje C</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/lenguajes-de-programacion/" class="nav-list-link">9.1. Los lenguajes de programación</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/introduccion-a-c/" class="nav-list-link">9.2. Introducción a C</a> </li><li class="nav-list-item active"> <a href="http://localhost:4000/docs/prog-y-3d/_site/escribiendo-programas-en-c/" class="nav-list-link active">9.3. Escribiendo programas en C</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/c-avanzado/" class="nav-list-link">9.4. Un poco de C avanzado</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/ejemplo-completo-3-en-raya/" class="nav-list-link">9.5. Un ejemplo completo. Las tres en raya</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/ejercicios-propuestos-c/" class="nav-list-link">9.6. Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/prog-y-3d/_site/ejercicios-resueltos-c/" class="nav-list-link">9.7. Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/prog-y-3d/_site/orientacion-a-objetos-c++/" class="nav-list-link">10. Orientación a objetos con C++</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/docs/prog-y-3d/_site/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PROG Y 3D" aria-label="Search PROG Y 3D" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/prog-y-3d/_site/">Introd. a la prog. y al diseño 3D</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/prog-y-3d/_site/lenguaje-c/">9. El lenguaje C</a></li> <li class="breadcrumb-nav-list-item"><span>9.3. Escribiendo programas en C</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 class="no_toc" id="93-escribiendo-programas-en-c"> <a href="#93-escribiendo-programas-en-c" class="anchor-heading" aria-labelledby="93-escribiendo-programas-en-c"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3. Escribiendo programas en C </h2> <ul id="markdown-toc"> <li><a href="#931-estructura-de-un-programa-en-c" id="markdown-toc-931-estructura-de-un-programa-en-c">9.3.1. Estructura de un programa en C</a></li> <li><a href="#932-compilar-y-ejecutar-un-programa-sencillo-desde-la-consola-gccg" id="markdown-toc-932-compilar-y-ejecutar-un-programa-sencillo-desde-la-consola-gccg">9.3.2. Compilar y ejecutar un programa sencillo desde la consola: gcc/g++</a></li> <li><a href="#933-compilar-y-ejecutar-un-programa-no-tan-sencillo-desde-la-consola-make" id="markdown-toc-933-compilar-y-ejecutar-un-programa-no-tan-sencillo-desde-la-consola-make">9.3.3. Compilar y ejecutar un programa no tan sencillo desde la consola: make</a></li> <li><a href="#934-compilar-y-ejecutar-un-programa-con-un-ide-visual-studio-code-con-code-runner" id="markdown-toc-934-compilar-y-ejecutar-un-programa-con-un-ide-visual-studio-code-con-code-runner">9.3.4. Compilar y ejecutar un programa con un IDE: Visual Studio Code con Code Runner</a></li> <li><a href="#935-flujo-de-trabajo-habitual" id="markdown-toc-935-flujo-de-trabajo-habitual">9.3.5. Flujo de trabajo habitual</a></li> </ul> <p>Ya conocemos cómo se manejan los principales elementos de un programa con C: variables, instrucciones de control, asignaciones, funciones, etc.</p> <p>Ahora nos queda saber cómo juntamos todo eso para escribir nuestros programas, ¿no te parece?</p> <h3 id="931-estructura-de-un-programa-en-c"> <a href="#931-estructura-de-un-programa-en-c" class="anchor-heading" aria-labelledby="931-estructura-de-un-programa-en-c"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3.1. Estructura de un programa en C </h3> <p>Ya estamos en condiciones de echar un vistazo a cual será el aspecto de (casi) todos los programas que escribamos en C.</p> <p>Los programas escritos en C suelen guardarse en dos tipos de archivo:</p> <ul> <li> <p><strong>Archivos con extensión .c</strong>. Estos archivos contienen el grueso del código fuente.</p> </li> <li> <p><strong>Archivos con extensión .h</strong>. Estos archivos contienen los prototipos de funciones y otras definiciones necesarias para que el programa funcione bien. Al principio, no escribirás ningún archivo de este tipo, pero sí que tendrás que incluir (con <em>#include</em>) muchos de ellos.</p> </li> </ul> <p>Todo programa C, desde el más pequeño hasta el más complejo, tiene un <strong>programa principal</strong> ubicado en la función <strong><em>main()</em></strong>, que debe ubicarse en un archivo con extensión .c.</p> <p>Además, por encima de <em>main()</em> deben aparecer los <strong>prototipos de funciones</strong> (y esto implica a los archivos de cabecera, si se utilizan funciones de librería) y las variables y constantes globales, si las hay. Por debajo de <em>main()</em> encontraremos el código de las funciones de usuario.</p> <p>Por lo tanto, la <strong>estructura habitual de nuestros programas en C</strong> debería ser esta:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* Comentario inicial: nombre del programa, del programador, fecha, etc */</span>

<span class="cm">/* Archivos de cabecera (prototipos de funciones de librería) */</span>
<span class="cp">#include</span> <span class="cpf">&lt;archivo_cabecera.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;archivo_cabecera.h&gt;</span><span class="cp">
</span>
<span class="cm">/* Prototipos de funciones escritas por nosotros */</span>
<span class="kt">float</span> <span class="n">funci</span><span class="err">ó</span><span class="n">n1</span> <span class="p">(</span><span class="n">argumentos</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">funci</span><span class="err">ó</span><span class="n">n2</span> <span class="p">(</span><span class="n">argumentos</span><span class="p">);</span>

<span class="cm">/* Variables globales */</span>
<span class="kt">int</span> <span class="n">variable_global1</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">variable_global2</span><span class="p">;</span>

<span class="cm">/* Algoritmo principal */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
   <span class="cm">/* Variables locales del algoritmo principal */</span>
   <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
   <span class="kt">float</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
   <span class="p">...</span>
   <span class="p">...</span>
   <span class="cm">/* Instrucciones del algoritmo principal */</span>
   <span class="p">...</span>
   <span class="n">funci</span><span class="err">ó</span><span class="n">n1</span><span class="p">(</span><span class="n">argumentos</span><span class="p">);</span>
   <span class="p">...</span>
   <span class="n">funci</span><span class="err">ó</span><span class="n">n2</span><span class="p">(</span><span class="n">argumentos</span><span class="p">);</span>
   <span class="p">...</span>
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Código completo de las funciones escritas por nosotros */</span>
<span class="kt">float</span> <span class="n">funci</span><span class="err">ó</span><span class="n">n1</span> <span class="p">(</span><span class="n">argumentos</span><span class="p">)</span>
<span class="p">{</span>
   <span class="cm">/* Variables locales e instrucciones de este subalgoritmo */</span>
<span class="p">}</span>
<span class="kt">float</span> <span class="n">funci</span><span class="err">ó</span><span class="n">n2</span> <span class="p">(</span><span class="n">argumentos</span><span class="p">)</span>
<span class="p">{</span>
   <span class="cm">/* Variables locales e instrucciones de este subalgoritmo */</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="932-compilar-y-ejecutar-un-programa-sencillo-desde-la-consola-gccg"> <a href="#932-compilar-y-ejecutar-un-programa-sencillo-desde-la-consola-gccg" class="anchor-heading" aria-labelledby="932-compilar-y-ejecutar-un-programa-sencillo-desde-la-consola-gccg"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3.2. Compilar y ejecutar un programa sencillo desde la consola: gcc/g++ </h3> <p>Vamos a aprender a compilar con <strong>gcc/g++</strong>, un compilador rápido, muy flexible y riguroso con el estándar de C/C++.</p> <p>En realidad, gcc compila C y g++ compila C++, pero por lo demás se usan de forma muy semejante.</p> <p>Se consideran dos de los mejores compiladores del mundo. Ten en cuenta que son herramientas de consola, es decir, que se usan <strong>escribiendo comandos</strong>, lo cual demuestra que <em>un gran programa no tiene por qué ser un programa “bonito”</em>. ¡Todo depende de a qué tipo de usuario vaya dirigido!</p> <p>En adelante, nos vamos a referir sobre todo a gcc, pero g++ es muy similar.</p> <h4 id="compilación-básica-con-gcc"> <a href="#compilación-básica-con-gcc" class="anchor-heading" aria-labelledby="compilación-básica-con-gcc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compilación básica con gcc </h4> <p>Casi siempre, gcc es invocado desde la herramienta <em>make</em>, cuyo funcionamiento se explica más adelante, pero antes debemos saber manejarlo mínimamente de forma manual.</p> <p>Vamos a compilar nuestro primer programa con gcc, que, como no podía ser de otra manera, será “hola mundo”. Supongamos que el código fuente de “hola mundo” se encuentra almacenado en el archivo <em>holamundo.c</em>. La compilación se realizaría con este comando:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gcc holamundo.c -o hola
</code></pre></div></div> <p>Esto compilará el código fuente de <em>holamundo.c</em> y generará un programa ejecutable llamado <em>hola</em>, que puedes ejecutar escribiendo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./hola
</code></pre></div></div> <h4 id="errores-y-warnings"> <a href="#errores-y-warnings" class="anchor-heading" aria-labelledby="errores-y-warnings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Errores y warnings </h4> <p>Si el compilador detecta en el código fuente <strong>errores</strong> en tiempo de compilación, lo comunica al programador del siguiente modo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gcc holamundo.c
holamundo.c: In function 'main':
holamundo.c:7: 'a' undeclared (first use in this function)
holamundo.c:7: (Each undeclared identifier is reported only once
holamundo.c:7: for each function it appears in.)
holamundo.c:7: parse error before 'return'
</code></pre></div></div> <p>Como ves, gcc te indica el fichero y la línea en la que ha detectado el error. Obviamente, cuando esto ocurre, no se crea archivo ejecutable como resultado. Debes corregir los errores e intentar la compilación de nuevo.</p> <p>Las <strong>advertencias</strong> (<strong><em>warnings</em></strong>) del compilador, en cambio, se consideran errores no críticos, por lo que no impiden la compilación del código.</p> <p>Las advertencias se muestran de un modo similar a los errores, indicando el archivo, la línea y la causa de la advertencia. Aunque no sean críticas, es una buena idea que las revises y las corrijas en caso necesario.</p> <h4 id="opciones-comunes"> <a href="#opciones-comunes" class="anchor-heading" aria-labelledby="opciones-comunes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Opciones comunes </h4> <p>A continuación mostramos algunas otras opciones habituales al usar gcc.</p> <ul> <li><strong>-help</strong>: Indica a gcc que muestre su salida de ayuda (muy reducida).</li> <li><strong>-o fichero</strong>: Especifica el nombre del archivo ejecutable que se generará como resultado de la compilación. Si no se indica ninguno, gcc creará un archivo llamado <em>a.out</em>.</li> <li><strong>-O nivel</strong>: Indica a gcc que utilice optimizaciones en el código. Los niveles posibles van desde 0 (no optimizar) hasta 3 (optimización máxima). Utilizar el optimizador aumenta el tiempo de compilación, pero suele generar ejecutables más rápidos.</li> <li><strong>-I directorio</strong>: Especifica un directorio adicional donde gcc debe buscar los archivos de cabecera indicados en el código fuente.</li> <li><strong>-L directorio</strong>: Especifica un directorio adicional donde gcc debe buscar las librerías necesarias en el proceso de enlazado.</li> <li><strong>-lLibrería</strong>: Especifica el nombre de una librería adicional que deberá ser utilizada en el proceso de enlazado.</li> </ul> <p>Por ejemplo, para compilar el programa <em>holamundo.c</em> con el nivel máximo de optimización y de manera que el ejecutable se llame “hola” y se enlace con la librería <em>ncurses</em>, el comando sería:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gcc -O3 -o hola -lncurses holamundo.c
</code></pre></div></div> <h3 id="933-compilar-y-ejecutar-un-programa-no-tan-sencillo-desde-la-consola-make"> <a href="#933-compilar-y-ejecutar-un-programa-no-tan-sencillo-desde-la-consola-make" class="anchor-heading" aria-labelledby="933-compilar-y-ejecutar-un-programa-no-tan-sencillo-desde-la-consola-make"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3.3. Compilar y ejecutar un programa no tan sencillo desde la consola: make </h3> <p>Cualquier proyecto de programación complejo consta de varios archivos fuente, puede incluso que de centenares de ellos.</p> <p>En este tipo de proyectos, los archivos se van compilando conforme se van construyendo, creándose un archivo binario a partir de cada archivo fuente. El archivo ejecutable final no se puede crear hasta que no se tienen disponibles todos los archivos binarios compilados.</p> <p>El proceso de composición de todos los archivos binarios en un archivo ejecutable final se denomina <strong>enlace</strong> o <strong>linkado</strong> (del inglés <em>link</em>).</p> <p>Hacer la compilación y enlace de múltiples archivos a mano es muy tedioso. Además, en proyectos complejos suele ocurrir que, cuando modificamos el código fuente de un archivo, otros archivos que dependan del que acabamos de modificar y también deben ser recompilados. En consecuencia, llevar un control sobre qué debe compilarse y qué no resulta complicado, y la opción de recompilar el proyecto entero todo el rato no es viable porque puede consumir muchísimo tiempo.</p> <p>La <strong>herramienta <em>make</em></strong> permite automatizar todo esto. Nos evita la tarea de comprobar las dependencias entre ficheros y se encarga de compilar solo lo que en cada momento debe ser compilado.</p> <p>Para ello se sirve de un fichero (cuyo nombre suele ser <em>Makefile</em>, aunque puede cambiarse) en el el programador tiene que especificar las <strong>dependencias</strong> entre ficheros de código fuente, así como las órdenes necesarias para actualizar cada fichero.</p> <p>Una vez escrito el fichero <em>Makefile</em>, cada vez que cambiemos algún fichero fuente, nos bastará invocar el comando <em>make</em> para que él solito revise todas las dependencias y recompile y enlace todos los archivos que sean necesarios.</p> <h4 id="el-fichero-makefile"> <a href="#el-fichero-makefile" class="anchor-heading" aria-labelledby="el-fichero-makefile"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> El fichero <em>Makefile</em> </h4> <p>El fichero <em>Makefile</em> más simple está compuesto por <em>reglas</em> de este aspecto:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objetivo ... : prerrequisitos ...
               comando
               ...
               ...
</code></pre></div></div> <ul> <li> <p>Un <strong>objetivo</strong> suele ser el nombre de un archivo generado por un programa; ejemplos de objetivos son los archivos de código objeto. Un objetivo puede ser también el nombre de una acción que debe llevarse a cabo, como <em>clean</em>, que veremos más adelante en un ejemplo.</p> </li> <li> <p>Un <strong>prerrequisito</strong> es un archivo que se usa como entrada para crear un objetivo. Un objetivo con frecuencia depende de varios archivos, así que en esta sección puede aparecer una lista de archivos.</p> </li> <li> <p>Un <strong>comando</strong> es una acción que <em>make</em> ejecuta cuando detecta que alguno de los prerrequisitos ha sido modificado. Debe ser un comando válido para el sistema operativo. Una regla puede tener más de un comando, cada uno en su propia línea. <em>Atención: ¡hay que poner un tabulador al principio de cada línea de comando!</em></p> </li> </ul> <p>¿Que no entiendes nada? ¡Normal! Lo verás mucho más claro con un ejemplo.</p> <h4 id="un-ejemplo-práctico"> <a href="#un-ejemplo-práctico" class="anchor-heading" aria-labelledby="un-ejemplo-práctico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Un ejemplo práctico </h4> <p>Nuestro ejemplo es un <em>Makefile</em> que describe la manera en la que un fichero ejecutable llamado <em>trivia</em> depende de tres ficheros objeto (binarios) que a su vez dependen de tres ficheros de código fuente C (.c) y uno cabecera (.h).</p> <p>El fichero <em>Makefile</em> debe indicar qué hay que recompilar cada vez que se modifica un archivo cualquiera. Échale un vistazo y lo comentamos más abajo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trivia: main.o display.o utils.o
       gcc -o trivia main.o display.o utils.o

main.o : main.c config.h
       gcc -c main.c

display.c : display.c config.h buffer.h
       gcc -c display.c

utils.o : utils.c config.h
       gcc -c utils.c

clean :
       rm -f trivia *.o
</code></pre></div></div> <p>Observa la primera línea. Ahí hemos dicho que el programa ejecutable (<em>trivia</em>) depende de los tres ficheros objeto (<em>main.o, display.o</em> y <em>utils.o</em>). Es decir, que si cambia cualquiera de ellos, <em>make</em> lo detectará y ejecutará el comando que aparece en la segunda línea. Y ese comando se encarga precisamente de volver a enlazar todos los ficheros objeto para generar de nuevo el archivo ejecutable <em>trivia</em>.</p> <p>La siguiente regla explica cómo se construye el archivo binario <em>main.o</em>: depende de <em>main.c</em> y de <em>config.h</em>, es decir, que se cambia cualquier cosa en alguno de esos dos archivos, <em>main.o</em> volverá a crearse con la línea que se indica justo debajo.</p> <p>Y lo mismo ocurre en todas las líneas del <em>Makefile</em>.</p> <p>La última regla (<em>clean</em>) es una regla especial que explicaremos enseguida.</p> <h4 id="cómo-usar-make"> <a href="#cómo-usar-make" class="anchor-heading" aria-labelledby="cómo-usar-make"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cómo usar <em>make</em> </h4> <p>Cuando ya dispones de tu archivo <em>Makefile</em> como el anterior, usar la herramienta <em>make</em> para compilar es sencillísimo:</p> <ul> <li>Para crear el archivo ejecutable bastará con escribir en la línea de comandos: <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ make
</code></pre></div> </div> <p>Al ejecutar <em>make</em>, solo se compilarán los archivos necesarios en cada momento (según lo que esté descrito en el <em>Makefile</em>).</p> </li> <li> <p>Para borrar el archivo ejecutable y todos los ficheros objeto del directorio, escribiremos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean
</code></pre></div> </div> <p>Para que <em>make clean</em> funcione, debe existir una sección <em>clean</em> en el archivo <em>Makefile</em>. Observa de nuevo el ejemplo de <em>Makefile</em> anterior y encontrarás al final la sección <em>clean</em>, donde se indica el comando que debe ejecutarse para borrar todos los archivos compilados.</p> </li> </ul> <p>Esto es lo más esencial de la herramienta <em>make</em>, pero, por supuesto, tiene otras muchas funciones que puedes investigar por tu cuenta cuando te vayan haciendo falta.</p> <h3 id="934-compilar-y-ejecutar-un-programa-con-un-ide-visual-studio-code-con-code-runner"> <a href="#934-compilar-y-ejecutar-un-programa-con-un-ide-visual-studio-code-con-code-runner" class="anchor-heading" aria-labelledby="934-compilar-y-ejecutar-un-programa-con-un-ide-visual-studio-code-con-code-runner"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3.4. Compilar y ejecutar un programa con un IDE: Visual Studio Code con Code Runner </h3> <p>Un <strong>IDE</strong> o Entorno Integrado de Desarrollo es un programa que contiene todo lo necesario para programar: un editor de texto, un compilador, un depurador, una consola de ejecución, una consola de errores y muchas otras cosas que no vamos a llegar a usar.</p> <p><strong><a href="https://code.visualstudio.com/">Visual Studio Code</a></strong> es un IDE muy popular desde hace un par de años. Es rápido, ligero, muy configurable, multiplataforma (funciona en Windows, Linux y Mac) y sirve para cualquier lenguaje imaginable. Con la extensión <strong>Code Runner</strong>, es facilísimo compilar y ejectuar código C/C++ con Visual Studio Code.</p> <p>Solo tienes que:</p> <ol> <li>Instalar Visual Studio Code y, dentro de él, la extensión Code Runner.</li> <li>Escribir tu programa en C.</li> <li>Pulsar el botón “Play” que aparecerá en la esquina superior derecha.</li> <li>Ver tu programa en funcionamiento en el terminal de la parte inferior.</li> </ol> <p>Puedes ver a Visual Studio Code en funcionamiento en esta capura de pantalla. Arriba y a la derecha están los botones de “Play” y “Stop” para lanzar y detener el programa. En el panel superior, el código fuente. En el panel inferior, el programa en ejecución. Y, a la izquierda, el navegador de archivos.</p> <p><img src="/docs/prog-y-3d/_site/assets/images/05-3-en-raya.png" alt="Ejecución del juego de las 3 en raya con Code Runner dentro de VS Code" /></p> <h3 id="935-flujo-de-trabajo-habitual"> <a href="#935-flujo-de-trabajo-habitual" class="anchor-heading" aria-labelledby="935-flujo-de-trabajo-habitual"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.3.5. Flujo de trabajo habitual </h3> <p>Cuando se trabaja con C, la implementación de un programa suele dividirse en varias subfases: edición, compilación, enlace y depuración. Te las describo brevemente:</p> <ol> <li> <p><strong>Edición del código fuente</strong>. Editar consiste en escribir el código fuente del programa en el lenguaje seleccionado, en nuestro caso C. Usaremos para ello <strong>Visual Studio Code</strong> con la extensión <strong>Code Runner</strong>.</p> </li> <li> <p><strong>Compilación</strong>. Una vez escrito el programa, debe traducirse a binario en el proceso llamado <em>compilación</em>. Esto puede hacerse desde la línea de comandos, como ya hemos visto, o de forma gráfica desde nuestro IDE. Este es el botón “Compile &amp; Run” de Code Runner, por ejemplo: <img src="/docs/prog-y-3d/_site/assets/images/05-code-runner-play-button.png" alt="Botón &quot;play&quot; de la extensión Code Runner" /></p> </li> <li> <p><strong>Enlace</strong>. Si tu programa es muy complejo, tu código fuente ocupará varios archivos. En tal caso, hay que compilarlos de uno en uno y después <em>enlazarlos</em> entre sí para generar un único programa ejecutable. Como vimos, esto puede hacerse con la herramienta <em>make</em> o, en caso de usar un IDE, dejar que sea él quien se encargue de hacer el enlace automáticamente.</p> </li> <li> <p><strong>Depuración</strong>. Ningún programa está bien escrito a la primera. Nunca. Lo normal es que el compilador te informe de que hay multitud de errores en tu código fuente. Tendrás que leer cuidadosamente los mensajes de error para corregirlos. Por fortuna, el compilador te informará de la línea exacta donde localizó el error, e incluso te dirá de qué tipo de error se trata.</p> <p>Una vez corregidos los errores de escritura, cuando el programa empiece a funcionar, es posible que no haga exactamente lo que tú pretendías que hiciera. También tendrás que corregir estos errores de ejecución.</p> <p>Por lo tanto, después de pasar por estos 4 pasos, tendrás que regresar de nuevo al paso 1 y volver a repetir el proceso hasta que tu programa funcione como es debido.</p> </li> </ol> <hr> <h2 class="text-delta">Table of contents</h2> <ul> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
