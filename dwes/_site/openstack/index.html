<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Apéndice IV. Despliegue con Openstack - DWES DOCS</title> <link rel="shortcut icon" href="/docs/dwes/_site/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/dwes/_site/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/docs/dwes/_site/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/dwes/_site/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Apéndice IV. Despliegue con Openstack | DWES DOCS</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Apéndice IV. Despliegue con Openstack" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="https://iescelia.org/docs/dwes/_site/openstack/" /> <meta property="og:url" content="https://iescelia.org/docs/dwes/_site/openstack/" /> <meta property="og:site_name" content="DWES DOCS" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Apéndice IV. Despliegue con Openstack" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","headline":"Apéndice IV. Despliegue con Openstack","url":"https://iescelia.org/docs/dwes/_site/openstack/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://iescelia.org/docs/dwes/_site/" class="site-title lh-tight"> DWES DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/algunas-cosas-que-debes-saber.html" class="nav-list-link">1.1 Algunas cosas que debes saber sobre los CMS</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/wordpress.html" class="nav-list-link">1.2 Wordpress</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/moodle.html" class="nav-list-link">1.3 Moodle</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/prestashop.html" class="nav-list-link">1.4 Prestashop</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/php/" class="nav-list-link">2 Introducción a PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/programacion-cliente-servidor.html" class="nav-list-link">2.1 Programación cliente-servidor</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/caja-de-herramientas.html" class="nav-list-link">2.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/sintaxis-de-php.html" class="nav-list-link">2.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/interaccion-con-php.html" class="nav-list-link">2.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/depuracion-php-xdebug.html" class="nav-list-link">2.5 Depurando el código PHP con xdebug</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/tdd.html" class="nav-list-link">2.6 TDD (test-driven development)</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/ejercicios-propuestos.html" class="nav-list-link">2.7 Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/ejercicios-resueltos.html" class="nav-list-link">2.8 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/cookies.html" class="nav-list-link">3.1 Cookies</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/sesiones.html" class="nav-list-link">3.2 Sesiones</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/control-de-acceso.html" class="nav-list-link">3.3. Sesiones, cookies y control de acceso</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/tecnicas-de-ataque-frecuentes.html" class="nav-list-link">3.4 Técnicas de ataque frecuentes</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/autenticacion-mediante-acl.html" class="nav-list-link">3.5 Autenticación mediante ACL</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-propuestos.html" class="nav-list-link">3.6 Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-resueltos.html" class="nav-list-link">3.7 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/mvc/" class="nav-list-link">4 Arquitectura MVC</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/que-es-un-framework.html" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/caracteristicas.html" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/instalacion.html" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/arquitectura-convenciones-configuracion.html" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/artisan.html" class="nav-list-link">5.5 Artisan, la consola que mola</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/hola-mundo-con-laravel.html" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/enrutamiento.html" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/vistas-y-plantillas-con-blade.html" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/controladores.html" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/migraciones.html" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/eloquent.html" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/querybuilder.html" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/sesiones.html" class="nav-list-link">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/helpers.html" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/flujo-de-trabajo-con-laravel.html" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/aspectos-avanzados.html" class="nav-list-link">5.16 Aspectos avanzados de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/crud-con-laravel.html" class="nav-list-link">5.17 CRUD desarrollado con Laravel</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/cgi.html" class="nav-list-link">8.1 CGI</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/perl.html" class="nav-list-link">8.2 Perl</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/python.html" class="nav-list-link">8.3 Python</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/punto-net.html" class="nav-list-link">8.4 .NET</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/jsp.html" class="nav-list-link">8.5 JSP</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/ruby.html" class="nav-list-link">8.6 Ruby</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/nodejs.html" class="nav-list-link">8.7 Node.js</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/mas-tecnologias-aun.html" class="nav-list-link">8.8 Más tecnologías aún</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/scv-git/" class="nav-list-link">Apéndice I. Sistemas de control de versiones. Git</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/docker/" class="nav-list-link">Apéndice II. Virtualización con Docker</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/vue-js/" class="nav-list-link">Apéndice III. Vue js</a></li><li class="nav-list-item active"><a href="https://iescelia.org/docs/dwes/_site/openstack/" class="nav-list-link active">Apéndice IV. Despliegue con Openstack</a></li></ul></li><li class="nav-list-item"><a href="https://iescelia.org/docs/dwes/_site/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DWES DOCS" aria-label="Search DWES DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://iescelia.org/docs/dwes/_site/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><span>Apéndice IV. Despliegue con Openstack</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="apéndice-4-despliegue-con-openstack"> <a href="#apéndice-4-despliegue-con-openstack" class="anchor-heading" aria-labelledby="apéndice-4-despliegue-con-openstack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Apéndice 4. Despliegue con Openstack </h1> <ul id="markdown-toc"> <li><a href="#a41-qué-es-openstack" id="markdown-toc-a41-qué-es-openstack">A4.1. ¿Qué es Openstack?</a></li> <li><a href="#a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web" id="markdown-toc-a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web">A4.2. Creando servidores en Openstack para desplegar aplicaciones web</a> <ul> <li><a href="#a421-caso-1-mi-aplicación-está-escrita-en-php-clásico" id="markdown-toc-a421-caso-1-mi-aplicación-está-escrita-en-php-clásico">A4.2.1. Caso 1: mi aplicación está escrita en PHP clásico</a></li> <li><a href="#a422-caso-2-mi-aplicación-está-escrita-con-laravel" id="markdown-toc-a422-caso-2-mi-aplicación-está-escrita-con-laravel">A4.2.2. Caso 2: mi aplicación está escrita con Laravel</a></li> </ul> </li> </ul> <h2 id="a41-qué-es-openstack"> <a href="#a41-qué-es-openstack" class="anchor-heading" aria-labelledby="a41-qué-es-openstack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A4.1. ¿Qué es Openstack? </h2> <p><strong>OpenStack</strong> es un proyecto <em>open source</em> que permite gestionar recursos virtuales de computación, redes, almacenamiento e imágenes, para diseñar y gestionar nubes privadas y públicas. Proporciona una virtualización de “infraestructura como servicio” o <em>IaaS</em> (Infraestructure as a Service).</p> <p>En palabras más simples, Openstack nos permite desplegar una nube en la que virtualizar cualquier infraestructura hardware razonablemente concebible: ordenadores, redes, dispositivos de almacenamiento, etc. Y, además, nos permite interconectar todos esos componentes entre sí.</p> <p>Por lo tanto, Openstack es perfecto para montar servidores web y de bases de datos adaptados a nuestras necesidades, de manera que podamos desplegar en ellos nuestras aplicaciones web.</p> <p>Como son servidores virtuales, es fácil crearlos, replicarlos, eliminarlos o modificarlos, incluso en caliente. Por ejemplo, puedes añadir más memoria RAM a un servidor sin necesidad siquiera de apagarlo.</p> <h2 id="a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web"> <a href="#a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web" class="anchor-heading" aria-labelledby="a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A4.2. Creando servidores en Openstack para desplegar aplicaciones web </h2> <p>José Juan Sánchez ha elaborado una completísima documentación sobre Openstack. La podéis encontrar aquí:</p> <p><a href="https://josejuansanchez.org/openstack-celia/">https://josejuansanchez.org/openstack-celia/</a></p> <p>No vamos a repetir aquí lo que ya pone en esa guía, porque además corresponde al módulo de “Despliegue de Aplicaciones Web”. Aquí solo resumiremos los pasos necesarios para crear un servidor en Openstack adecuado para desplegar tus aplicaciones:</p> <ol> <li> <p><strong>Accede a Openstack</strong> en <a href="https://172.16.0.11">https://172.16.0.11</a>. Lógicamente, necesitarás una cuenta de usuario en vigor.</p> </li> <li> <p><strong>Crea una instancia nueva</strong> (por ejemplo, un Ubuntu 22.04 con 10 GB de disco y 1 GB de RAM debería ser suficiente para un servidor normalito).</p> </li> <li> <p><strong>Asocia una IP flotante</strong> a la instancia. Es la única forma de poder entrar a tu máquina virtual posteriormente.</p> </li> <li> <p><strong>Lanza la instancia y conéctate por SSH</strong> con ella. Necesitarás crear un par de claves SSH y guardar tu clave privada en un archivo llamado “id_rsa” de tu usuario (la ubicación de este archivo depende del sistema operativo; tendrás que consultar dónde hacerlo según que sistema uses):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh ubuntu@dirección_IP
</code></pre></div> </div> </li> <li> <p><strong>Añade una regla al grupo de seguridad de Openstack para poder acceder al servidor por http</strong>. Esto se hace desde el panel de administración de Openstack, siguiendo esta ruta: <em>Openstack -&gt; grupos de seguridad -&gt; Admin reglas -&gt; Agregar reglas</em>. Después, añade un “Acceso por HTTP”.</p> </li> <li> <p><strong>Instala docker, docker-compose, git y composer</strong> en la máquina virtual (bueno, y cualquier otra cosa que te sea necesaria para tu aplicación). Para ello, conéctate a tu máquina virtual por SSH y teclea esto:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo apt install docker docker-compose git composer
 $ sudo adduser ubuntu docker  (Añadir usuario "ubuntu" al grupo "docker")
</code></pre></div> </div> </li> <li> <p><strong>Instala el software necesario para que tu aplicación web funcione</strong>. Esto se puede hacer de forma nativa, instalado Apache, MySQL y todo lo que tu aplicación necesite, o virtualizando todos esos componentes con Docker, que es más fácil, escalable y recomendable.</p> <p>Como es diferente desplegar una aplicación web escrita en PHP clásico que hacerlo con una escrita con Laravel, vamos a mostrar los siguientes pasos de forma diferenciada para cada situación.</p> </li> </ol> <h3 id="a421-caso-1-mi-aplicación-está-escrita-en-php-clásico"> <a href="#a421-caso-1-mi-aplicación-está-escrita-en-php-clásico" class="anchor-heading" aria-labelledby="a421-caso-1-mi-aplicación-está-escrita-en-php-clásico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A4.2.1. Caso 1: mi aplicación está escrita en PHP clásico </h3> <p>Asegúrate de que has seguido correctamente los pasos previos expuestos en el <a href="../openstack/#a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web">apartado A4.2</a> antes de continuar por aquí.</p> <ol> <li> <p><strong>Monta los contenedores Docker necesarios para crear un servidor web</strong>. Para ello, puedes seguir los pasos que detallamos en el ejemplo del <a href="../docker/#a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos">Apéndice 2</a>, donde montamos un servidor con Apache, PHP, MariaDB y PHPMyAdmin. Por supuesto, estos pasos los tienes que ejecutar en tu máquina virtual de Openstack, conectándote a ella por SSH, no en tu máquina local.</p> </li> <li> <p><strong>Lanza los contenedores con <em>docker-compose</em></strong>. Si has seguido correctamente los pasos para montar el servidor que detallamos en el Apéndice 2, con esto tu servidor estará escuchando en la IP flotante que hayas asignado a tu máquina virtual.</p> </li> <li> <p><strong>Despliega tu código</strong>. Si usas <em>git</em> (como deberías estar haciendo), es tan simple como hacer <code class="language-plaintext highlighter-rouge">git clone</code> en el directorio donde hayas lanzado Docker.</p> </li> </ol> <p>¡Listo! Tu aplicación estará respondiendo en la IP flotante que hayas configurado. Compruébalo con tu navegador web preferido.</p> <h3 id="a422-caso-2-mi-aplicación-está-escrita-con-laravel"> <a href="#a422-caso-2-mi-aplicación-está-escrita-con-laravel" class="anchor-heading" aria-labelledby="a422-caso-2-mi-aplicación-está-escrita-con-laravel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A4.2.2. Caso 2: mi aplicación está escrita con Laravel </h3> <p>Asegúrate de que has seguido correctamente los pasos previos expuestos en el <a href="../openstack/#a42-creando-servidores-en-openstack-para-desplegar-aplicaciones-web">apartado A4.2</a> antes de continuar por aquí.</p> <p>Para usar Laravel, debes instalar todas las dependencias en el servidor. Esto puede ser complicado, porque Laravel requiere de bastantes componentes. Por eso es recomendable instalarlo también con <strong>Docker</strong> (es decir, instalar <strong>Laravel Sail</strong>).</p> <p>Los pasos para lograrlo serían los siguientes (recuerda que debes ejecutarlos en tu servidor, conectándote a él por SSH):</p> <ol> <li> <p><strong>Si queremos una instalación de Laravel limpia</strong> haremos esto en la máquina virtual:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ curl -s https://laravel.build/mi-app | bash   (cambiar "mi-app" por otro nombre para la app)
 $ cd mi-app (o el directorio que hayas elegido en la instrucción anterior)
 $ ./vendor/bin/sail up -d
</code></pre></div> </div> <p>En cambio, <strong>si ya tienes una aplicación Laravel funcionando</strong> (por ejemplo, en tu localhost), bastará con que la clones con <code class="language-plaintext highlighter-rouge">git clone</code> o, si no usas <em>git</em> (mal hecho), que copies el código manualmente a tu máquina virtual con <em>scp</em>.</p> </li> <li> <p><strong>Instalar las dependencias de PHP y lanzar migraciones</strong>. Si tu aplicación Laravel no tiene directorio “vendor”, tendrás que generarlo con <em>composer</em>. Y crear la estructura de la base de datos lanzando tus migraciones:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ ./vendor/bin/sail composer update    (necesitas tener al menos "sail" dentro de "vendor")
 $ php artisan migrate:fresh --seed     (necesitarás configurar antes el .env)
</code></pre></div> </div> </li> <li> <p><strong>Resolver problemas de permisos</strong>. Si la aplicación Laravel da un error de acceso al directorio “storage”, concédele permisos 777:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo chmod -R 777 storage
 $ ./vendor/bin/sail artisan cache:clear
 $ ./vendor/bin/sail artisan config:clear
 $ ./vendor/bin/sail artisan config:cache
</code></pre></div> </div> </li> <li> <p><strong>Resolver problemas con sesiones, caché y vistas</strong>. Si la aplicación Laravel da errores con la sesiones, la caché o las vistas, asegúrate de que dentro del directorio <em>/storage/framework</em> existen los subdirectorios <em>cache</em>, <em>sessions</em> y <em>views</em>, los tres con permisos 777. Si no existen, créalos.</p> </li> <li> <p><strong>Lanzar Node</strong> (si es necesario). Si tu aplicación Laravel usa Node (por ejemplo, porque hayas instalado Laravel Breeze), tendrás que lanzar Node en el servidor:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ ./vendor/bin/sail npm install
 $ ./vendor/bin/sail npm run dev
</code></pre></div> </div> <p>Eso dejará el servidor Node corriendo. No lo detengas: necesitará estár permanentemente activo (como Sail) para que la aplicación Laravel funcione bien.</p> <p>Hemos observado que, en el servidor Ubuntu de Openstack, el comando <code class="language-plaintext highlighter-rouge">npm run dev</code> puede dar el error “ENOSPC: System limit for number of file watchers reached”. Si te sucede esto, haz lo siguiente:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo nano /etc/sysctl.conf
</code></pre></div> </div> <p>Ahora añade esta línea al final de archivo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> fs.inotify.max_user_watches = 524288
</code></pre></div> </div> <p>Con eso, <code class="language-plaintext highlighter-rouge">npm run dev</code> debería funcionar bien.</p> </li> </ol> <p>¡Listo! Con esto, deberías tener tu servidor escuchando en la IP flotante que hayas asignado a tu máquina virtual.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
