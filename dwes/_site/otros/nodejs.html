<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>8.7 NodeJS - DWES DOCS</title> <link rel="shortcut icon" href="/docs/dwes/_site/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/dwes/_site/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/docs/dwes/_site/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/dwes/_site/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>8.7 NodeJS | DWES DOCS</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="8.7 NodeJS" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="/docs/dwes/_site/otros/nodejs.html" /> <meta property="og:url" content="/docs/dwes/_site/otros/nodejs.html" /> <meta property="og:site_name" content="DWES DOCS" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="8.7 NodeJS" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/docs/dwes/_site/otros/nodejs.html","headline":"8.7 NodeJS","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/docs/dwes/_site/" class="site-title lh-tight"> DWES DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/dwes/_site/cms/algunas-cosas-que-debes-saber.html" class="nav-list-link">1.1 Algunas cosas que debes saber sobre los CMS</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cms/wordpress.html" class="nav-list-link">1.2 Wordpress</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cms/moodle.html" class="nav-list-link">1.3 Moodle</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cms/prestashop.html" class="nav-list-link">1.4 Prestashop</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/php/" class="nav-list-link">2 Introducción a PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/dwes/_site/php/programacion-cliente-servidor.html" class="nav-list-link">2.1 Programación cliente-servidor</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/php/caja-de-herramientas.html" class="nav-list-link">2.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/php/sintaxis-de-php.html" class="nav-list-link">2.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/php/interaccion-con-php.html" class="nav-list-link">2.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/php/ejercicios-resueltos.html" class="nav-list-link">2.5 Ejercicios resueltos</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/php/ejercicios-propuestos.html" class="nav-list-link">2.6 Ejercicios propuestos</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/cookies.html" class="nav-list-link">3.1 Cookies</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/sesiones.html" class="nav-list-link">3.2 Sesiones</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/control-de-acceso.html" class="nav-list-link">3.3. Sesiones, cookies y control de acceso</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/tecnicas-de-ataque-frecuentes.html" class="nav-list-link">3.4 Técnicas de ataque frecuentes</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/autenticacion-mediante-acl.html" class="nav-list-link">3.5 Autenticación mediante ACL</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-propuestos.html" class="nav-list-link">3.6 Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-resueltos.html" class="nav-list-link">3.7 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="/docs/dwes/_site/mvc/" class="nav-list-link">4 Arquitectura MVC</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/que-es-un-framework.html" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/caracteristicas.html" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/instalacion.html" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/arquitectura-convenciones-configuracion.html" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/artisan.html" class="nav-list-link">5.5 Artisan, la consola que mola</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/hola-mundo-con-laravel.html" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/enrutamiento.html" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/vistas-y-plantillas-con-blade.html" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/controladores.html" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/migraciones.html" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/eloquent.html" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/querybuilder.html" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/sesiones.html" class="nav-list-link">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/helpers.html" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/flujo-de-trabajo-con-laravel.html" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/aspectos-avanzados.html" class="nav-list-link">5.16 Aspectos avanzados de Laravel</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/laravel/crud-con-laravel.html" class="nav-list-link">5.17 CRUD desarrollado con Laravel</a> </li></ul></li><li class="nav-list-item "><a href="/docs/dwes/_site/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="/docs/dwes/_site/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/dwes/_site/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/cgi.html" class="nav-list-link">8.1 CGI</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/perl.html" class="nav-list-link">8.2 Perl</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/python.html" class="nav-list-link">8.3 Python</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/punto-net.html" class="nav-list-link">8.4 .NET</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/jsp.html" class="nav-list-link">8.5 JSP</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/ruby.html" class="nav-list-link">8.6 Ruby</a> </li><li class="nav-list-item active"> <a href="/docs/dwes/_site/otros/nodejs.html" class="nav-list-link active">8.7 NodeJS</a> </li><li class="nav-list-item "> <a href="/docs/dwes/_site/otros/mas-tecnologias-aun.html" class="nav-list-link">8.8 Más tecnologías aún</a> </li></ul></li><li class="nav-list-item "><a href="/docs/dwes/_site/scv-git/" class="nav-list-link">Apéndice I. Sistemas de control de versiones. Git</a></li></ul></li><li class="nav-list-item"><a href="/docs/dwes/_site/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DWES DOCS" aria-label="Search DWES DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/dwes/_site/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/dwes/_site/otras-tecnologias/">8 Otras tecnologías</a></li> <li class="breadcrumb-nav-list-item"><span>8.7 NodeJS</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 id="87-nodejs"> <a href="#87-nodejs" class="anchor-heading" aria-labelledby="87-nodejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7. Node.js </h2> <div style="color:red"><strong>ATENCIÓN: esta sección aún está en construcción.</strong></div> <p><strong>Node.js</strong> no es un lenguaje de programación, sino un entorno de ejecución en el lado del servidor (aunque puede funcionar en otros entornos) basado en el lenguaje <strong>Javascript</strong>.</p> <p>Por lo tanto, al contrario que el código Javascript convencional, Node.js ejecuta Javascript en el servidor. De este modo, pueden unificarse los lenguajes del lado del cliente y del servidor. Esa es una de las razones que explica el rápido crecimiento que Node.js está experimentando en los últimos años.</p> <p>Vamos a ver una introducción muy breve a Node.js. Ten en cuenta que, además, Node.js no suele usarse de forma independiente para desarrollar aplicaciones web, sino en conjunción con algún framework como <strong>Express</strong>.</p> <h3 id="871-características-del-lenguaje-nodejs"> <a href="#871-características-del-lenguaje-nodejs" class="anchor-heading" aria-labelledby="871-características-del-lenguaje-nodejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.1. Características del lenguaje Node.js </h3> <p>Fecha de aparición: 2009</p> <p>Perspectivas:</p> <ul> <li>Uso y popularidad creciente.</li> <li>Posibilidad de convertirse en un estándar de desarrollo web <em>fullstack</em>.</li> <li>Buena relación señal/ruido.</li> <li>Node.js tiene problemas que resolver si quiere imponerse como estándar: la API cambia continuamente y no es compatible hacia atrás, la librería estándar de Javascript es minúscula comparada con otros lenguajes y las librerías de terceros son a veces poco probadas, cambiantes o directamente inexistentes para hacer ciertas cosas que en otras plataformas se dan por supuestas.</li> </ul> <p>Filosofía:</p> <ul> <li>Usa el motor de JavaScript V8 de Chrome <em>fuera del navegador</em> para ejecutarse en el servidor.</li> <li>Las operaciones de E/S son <em>sin bloqueo</em>, esto es, <em>asíncronas</em>.</li> <li>El fluje de ejecución no es lineal, sino <em>dirigido por eventos</em>, como ocurre casi siempre en las aplicaciones web. Esto mejora el rendimiento, porque el programa está casi todo el tiempo ocioso, a la espera de que ocurra algún evento.</li> <li>Tiene acceso nativo a bases de datos documentales como <em>MongoDB</em>.</li> <li>Las aplicaciones altamente escalables.</li> <li>Simplicidad y modularidad.</li> <li>Gestor <strong>npm</strong> para librerías de terceros.</li> </ul> <h3 id="872-configuración-necesaria-en-el-servidor"> <a href="#872-configuración-necesaria-en-el-servidor" class="anchor-heading" aria-labelledby="872-configuración-necesaria-en-el-servidor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.2. Configuración necesaria en el servidor </h3> <p>Node.js <strong>incluye su propio servidor web</strong>. Recuerda que Node.js <em>no</em> es un lenguaje de programación, sino una plataforma de desarrollo en el lado del servidor completa.</p> <p>Así que, para lanzar un servidor web con Node.js, lo único que debemos instalar en el servidor es el propio Node.js.</p> <p>Una vez hecho esto, podemos crear un servidor HTTP básico creando un programa Javascript como este:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">peticion</span><span class="p">,</span> <span class="nx">respuesta</span><span class="p">)</span> 
	<span class="c1">// Aquí se escribe la respuesta del servidor</span>
<span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9000</span><span class="p">,</span> <span class="dl">'</span><span class="s1">127.0.0.1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// Puerto e IP donde escuchará el servidor</span>
</code></pre></div></div> <p>Luego bastará con ejecutar este programa en el servidor desde una consola de comandos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ node nombre-del-archivo.js
</code></pre></div></div> <h3 id="873-sintaxis-básica-de-nodejs"> <a href="#873-sintaxis-básica-de-nodejs" class="anchor-heading" aria-labelledby="873-sintaxis-básica-de-nodejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.3. Sintaxis básica de Node.js </h3> <p>El lenguaje de programación que usa Node.js es Javascript, así que hay poco que decir sobre la sintaxis de las estructuras de control, las asignaciones o los operadores, puesto que ya la conoces.</p> <h3 id="874-entrada--salida-con-nodejs"> <a href="#874-entrada--salida-con-nodejs" class="anchor-heading" aria-labelledby="874-entrada--salida-con-nodejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.4. Entrada / Salida con Node.js </h3> <p>La entrada y salida en un entorno Node.js es lo que más se diferencia del Javascript que manejas habitualmente, puesto que ahora estamos trabajando en un servidor, no en un navegador web.</p> <p>La salida mediante <strong>console.log()</strong> puede seguir usándose, pero no es lo habitual en aplicaciones web, puesto que esa salida se producirá en la consola de texto del servidor. Para la entrada, existe la función <strong>openStdin()</strong>, que crea un objeto sobre el que se puede agregar un evento de entrada de datos, como en este ejemplo:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Escribe tu nombre</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">stdin</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">openStdin</span><span class="p">();</span>

<span class="nx">stdin</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">entradaPorTeclado</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Tu nombre es: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">entradaPorTeclado</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">});</span>
</code></pre></div></div> <p>Aquí se puede ver <strong>qué significa que Node.js sea un entorno de ejecución dirigido por eventos</strong>: en lugar de lanzar la lectura por teclado y dejar al programa esperando hasta que esa lectura por teclado se produzca, lo que hacemos es asignar un <strong>manejador de evento</strong> o <strong>listener</strong> que se ejecutará cuando ocurra cierto evento asociado.</p> <p>En este ejemplo, asociamos un <em>listener</em> al objeto <em>stdin</em>. Cuando ocurra el evento (en este caso, el evento se llama “data”, que significa “recepción de datos” en el objeto <em>stdin</em>), se ejecutará el código de la función. Mientras tanto, el programa continuará con su ejecución normal, atendiendo a cualquier otro evento que pudiera producirse y que esté programado para atender.</p> <p>Sin embargo, en una aplicación web, raramente se hace la entrada y salida por consola, ¿verdad? <strong>La entrada debería hacerse desde un formulario web, mientras que la salida debería ser una respuesta HTTP</strong>.</p> <p>Te muestro cómo se hace esto con Node.js con otro ejemplo:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">datos_del_post</span><span class="p">;</span>
<span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">peticion</span><span class="p">,</span> <span class="nx">respuesta</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span><span class="p">(</span><span class="nx">peticion</span><span class="p">.</span><span class="nx">method</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">datos_del_post</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
      <span class="nx">peticion</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">trozo_de_datos</span><span class="p">){</span>
         <span class="nx">datos_del_post</span> <span class="o">+=</span> <span class="nx">trozo_de_datos</span><span class="p">;</span>
      <span class="p">});</span>
      <span class="nx">peticion</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
         <span class="kd">var</span> <span class="nx">datos_del_post</span> <span class="o">=</span> <span class="nx">querystring</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">datos_del_post</span><span class="p">);</span>
         <span class="nx">respuesta</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">});</span>
         <span class="nx">respuesta</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">He recibido correctamente el formulario</span><span class="dl">"</span><span class="p">);</span>
         <span class="nx">respuesta</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">Estos son los datos que me han llegado:</span><span class="dl">"</span><span class="p">);</span>
         <span class="nx">respuesta</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">Nombre: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">datos_del_post</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">. Email = </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">datos_del_post</span><span class="p">.</span><span class="nx">email</span><span class="p">);</span>
         <span class="nx">respuesta</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
      <span class="p">});</span>
   <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nx">respuesta</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">});</span>
      <span class="nx">respuesta</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">No he ha llegado ningún dato por POST</span><span class="dl">"</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9000</span><span class="p">,</span> <span class="dl">'</span><span class="s1">127.0.0.1</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div> <p>Si observas este código, verás que tiene la misma estructura que el que vimos en el apartado “Configuración necesaria en el servidor”, solo que hemos rellenado la función principal con más cosas.</p> <p>Esa función tiene dos argumentos, <strong><em>petición</em></strong> y <strong><em>respuesta</em></strong>:</p> <ul> <li>En <strong><em>petición</em></strong>, el servidor coloca todos los datos de la petición que proviene del cliente. La información del formulario estará aquí, por lo tanto.</li> <li>En <strong><em>respuesta</em></strong>, el servidor colocará todos los datos de la respuesta HTTP que va a enviar al cliente.</li> </ul> <p>Fíjate cómo en el código, en primer lugar, miramos si la petición del cliente nos llegó por POST. Si es así, creamos dos manejadores de eventos:</p> <ul> <li>El manejador <strong>“data”</strong> se ejecutará cuando llegue un nuevo fragmento de información por POST.</li> <li>El manejador <strong>“end”</strong> se ejecutará cuando haya terminado de recibirse información desde el cliente.</li> </ul> <p>Por eso, en el manejador “data” nos limitamos a ir encadenando los datos que llegan por POST en la variable <em>datos_del_post</em>, y es en el manejador “end” cuando los procesamos. Observa cómo en ese manejador generamos la respuesta HTTP mediante el método <strong><em>write()</em></strong>. La respuesta se envía al cliente cuando se ejecuta el método <strong><em>end()</em></strong>.</p> <h3 id="875-bibliotecas-funciones-y-clases"> <a href="#875-bibliotecas-funciones-y-clases" class="anchor-heading" aria-labelledby="875-bibliotecas-funciones-y-clases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.5. Bibliotecas, funciones y clases </h3> <p>TODO XXX</p> <h3 id="876-ejemplo-1-en-nodejs-hola-mundo"> <a href="#876-ejemplo-1-en-nodejs-hola-mundo" class="anchor-heading" aria-labelledby="876-ejemplo-1-en-nodejs-hola-mundo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.6. Ejemplo 1 en Node.js: Hola mundo </h3> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> 
	<span class="c1">// Cabecera http. No es imprescindible, pero sí recomendable.</span>
	<span class="c1">// Recuerda que el código 200 significa "OK" en el protocolo http/https.</span>
	<span class="c1">// El 'Content-type' más habitual es 'text/html' o 'application/json'. </span>
	<span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/html</span><span class="dl">'</span><span class="p">);</span> 
	<span class="nx">res</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hola, mundo!</span><span class="dl">'</span><span class="p">);</span> 
	<span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="p">).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9000</span><span class="p">);</span> <span class="c1">// Puerto donde el servidor escuchará</span>
</code></pre></div></div> <h3 id="877-ejemplo-2-en-nodejs-login-con-comprobación-de-email-por-ajax"> <a href="#877-ejemplo-2-en-nodejs-login-con-comprobación-de-email-por-ajax" class="anchor-heading" aria-labelledby="877-ejemplo-2-en-nodejs-login-con-comprobación-de-email-por-ajax"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8.7.7. Ejemplo 2 en Node.js: login con comprobación de email por Ajax </h3> <p>TODO XXX</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
