<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Apéndice II. Virtualización con Docker - DWES DOCS</title> <link rel="shortcut icon" href="/docs/dwes/_site/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/dwes/_site/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/docs/dwes/_site/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/dwes/_site/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Apéndice II. Virtualización con Docker | DWES DOCS</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Apéndice II. Virtualización con Docker" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="https://iescelia.org/docs/dwes/_site/docker/" /> <meta property="og:url" content="https://iescelia.org/docs/dwes/_site/docker/" /> <meta property="og:site_name" content="DWES DOCS" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Apéndice II. Virtualización con Docker" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","headline":"Apéndice II. Virtualización con Docker","url":"https://iescelia.org/docs/dwes/_site/docker/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://iescelia.org/docs/dwes/_site/" class="site-title lh-tight"> DWES DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/algunas-cosas-que-debes-saber.html" class="nav-list-link">1.1 Algunas cosas que debes saber sobre los CMS</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/wordpress.html" class="nav-list-link">1.2 Wordpress</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/moodle.html" class="nav-list-link">1.3 Moodle</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cms/prestashop.html" class="nav-list-link">1.4 Prestashop</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/php/" class="nav-list-link">2 Introducción a PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/programacion-cliente-servidor.html" class="nav-list-link">2.1 Programación cliente-servidor</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/caja-de-herramientas.html" class="nav-list-link">2.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/sintaxis-de-php.html" class="nav-list-link">2.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/interaccion-con-php.html" class="nav-list-link">2.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/depuracion-php-xdebug.html" class="nav-list-link">2.5 Depurando el código PHP con xdebug</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/tdd.html" class="nav-list-link">2.6 TDD (test-driven development)</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/ejercicios-propuestos.html" class="nav-list-link">2.7 Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/php/ejercicios-resueltos.html" class="nav-list-link">2.8 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/cookies.html" class="nav-list-link">3.1 Cookies</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/sesiones.html" class="nav-list-link">3.2 Sesiones</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/control-de-acceso.html" class="nav-list-link">3.3. Sesiones, cookies y control de acceso</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/tecnicas-de-ataque-frecuentes.html" class="nav-list-link">3.4 Técnicas de ataque frecuentes</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/autenticacion-mediante-acl.html" class="nav-list-link">3.5 Autenticación mediante ACL</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-propuestos.html" class="nav-list-link">3.6 Ejercicios propuestos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/cookies-sesiones-seguridad/ejercicios-resueltos.html" class="nav-list-link">3.7 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/mvc/" class="nav-list-link">4 Arquitectura MVC</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/que-es-un-framework.html" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/caracteristicas.html" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/instalacion.html" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/arquitectura-convenciones-configuracion.html" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/artisan.html" class="nav-list-link">5.5 Artisan, la consola que mola</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/hola-mundo-con-laravel.html" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/enrutamiento.html" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/vistas-y-plantillas-con-blade.html" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/controladores.html" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/migraciones.html" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/eloquent.html" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/querybuilder.html" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/sesiones.html" class="nav-list-link">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/helpers.html" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/flujo-de-trabajo-con-laravel.html" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/aspectos-avanzados.html" class="nav-list-link">5.16 Aspectos avanzados de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/laravel/crud-con-laravel.html" class="nav-list-link">5.17 CRUD desarrollado con Laravel</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/dwes/_site/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/cgi.html" class="nav-list-link">8.1 CGI</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/perl.html" class="nav-list-link">8.2 Perl</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/python.html" class="nav-list-link">8.3 Python</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/punto-net.html" class="nav-list-link">8.4 .NET</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/jsp.html" class="nav-list-link">8.5 JSP</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/ruby.html" class="nav-list-link">8.6 Ruby</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/nodejs.html" class="nav-list-link">8.7 Node.js</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/dwes/_site/otros/mas-tecnologias-aun.html" class="nav-list-link">8.8 Más tecnologías aún</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/dwes/_site/scv-git/" class="nav-list-link">Apéndice I. Sistemas de control de versiones. Git</a></li><li class="nav-list-item active"><a href="https://iescelia.org/docs/dwes/_site/docker/" class="nav-list-link active">Apéndice II. Virtualización con Docker</a></li></ul></li><li class="nav-list-item"><a href="https://iescelia.org/docs/dwes/_site/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DWES DOCS" aria-label="Search DWES DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://iescelia.org/docs/dwes/_site/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><span>Apéndice II. Virtualización con Docker</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="apéndice-2-virtualización-con-docker"> <a href="#apéndice-2-virtualización-con-docker" class="anchor-heading" aria-labelledby="apéndice-2-virtualización-con-docker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Apéndice 2. Virtualización con Docker </h1> <ul id="markdown-toc"> <li><a href="#a21-qué-es-docker" id="markdown-toc-a21-qué-es-docker">A2.1. ¿Qué es Docker?</a></li> <li><a href="#a22-comandos-usuales-de-docker" id="markdown-toc-a22-comandos-usuales-de-docker">A2.2. Comandos usuales de Docker</a></li> <li><a href="#a23-persistencia-de-datos" id="markdown-toc-a23-persistencia-de-datos">A2.3. Persistencia de datos</a></li> <li><a href="#a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos" id="markdown-toc-a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos">A2.4. Un ejemplo: montando un servidor web con persistencia de datos</a></li> </ul> <h2 id="a21-qué-es-docker"> <a href="#a21-qué-es-docker" class="anchor-heading" aria-labelledby="a21-qué-es-docker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A2.1. ¿Qué es Docker? </h2> <p><strong>Docker</strong> es una herramienta de virtualización basada en <em>contenedores</em>.</p> <p>Un <strong>contenedor</strong> es un paquete de software completamente independiente del sistema donde se ejecuta. Recibe ese nombre por los contenedores que se utilizan en el transporte marítimo, que tienen unas medidas y una forma estandarizada y que aislan por completo la carga que llevan dentro del exterior.</p> <p>Un contenedor Docker hace lo mismo, pero con un conjunto de software: lo aisla por completo del exterior. El software que hay dentro del contenedor se puede ejecutar en cualquier máquina gracias al <em>runtime</em> de Docker, que se comporta como un mini-sistema operativo virtualizado que corre sobre la máquina anfitrión.</p> <p>Un contenedor puede contener cualquier cosa. Por ejemplo, Apache. De ese modo, podemos ejecutar Apache en cualquier máquina (siempre que tenga previamente instalado Docker) sin necesidad de instalarlo realmente, con todo lo que ello conlleva de configuración de la máquina, consumo de recursos, etc. El contenedor Docker puede ponerse en marcha cuando queramos y detenerse en cualquier momento, sin dejar ningún rastro en la máquina anfitriona.</p> <p>En definitiva, puedes usar y/o testear <em>cualquier</em> programa sin tener que instalarlo realmente en tu máquina.</p> <p>Los contenedores Docker vienen empaquetados en <strong>imágenes</strong>, a partir de los cuales pueden lanzarse todos los contenedores que necesitemos. Es decir, las imágenes con como las <em>clases</em> en programación orientada a objetos, y los contenedores son como los objetos que se instancian a partir de esas clases.</p> <p>Cada cual puede construir las imágenes que necesite o usar imágenes ya hechas, con todo lo necesario en su interior para ejecutar cualquier software sin necesidad de instalarlo ni configurarlo. Hay repositorios públicos de imágenes, como <strong>DockerHub</strong>, donde uno puede encontrar imágenes de prácticamente cualquier cosa.</p> <h2 id="a22-comandos-usuales-de-docker"> <a href="#a22-comandos-usuales-de-docker" class="anchor-heading" aria-labelledby="a22-comandos-usuales-de-docker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A2.2. Comandos usuales de Docker </h2> <p>Aunque Docker puede usarse desde un interfaz gráfico (como <strong>Docker Desktop</strong>), lo habitual es hacerlo desde la línea de comandos.</p> <p>Esto no es un manual de Docker, pero sí vamos a enumerar aquí los comandos principales que nos serán útiles como desarrolladores web para que puedas usarlos como referencia rápida cuando tengas que trabajar con Docker.</p> <ul> <li><code class="language-plaintext highlighter-rouge">docker run [nombre-imagen]</code> - Lanza un contenedor a partir de la imagen especificada. Si la imagen no está descargada en el ordenador, la buscará en el repositorio configurado (por defecto, <em>DockerHub</em>).</li> <li><code class="language-plaintext highlighter-rouge">docker ps</code> - Muestra un listado con los contenedores que hay actualmente en el sistema. Un contenedor no tiene por qué estar necesariamente corriendo, sino que existen otros estados (detenido, preparado, finalizado, etc). Con <code class="language-plaintext highlighter-rouge">docker ps -a</code> podemos ver todos los contenedores, también los detenidos.</li> <li><code class="language-plaintext highlighter-rouge">docker stop [id-del-contenedor]</code> - Detiene un contenedor. Su id puede obtenerse con <code class="language-plaintext highlighter-rouge">docker ps</code>.</li> <li><code class="language-plaintext highlighter-rouge">docker start [id-del-contenedor]</code> - Reanuda un contenedor.</li> <li><code class="language-plaintext highlighter-rouge">docker exec -it [id-del-contenedor] bash</code> - Abrir un terminal en el contenedor.</li> <li><code class="language-plaintext highlighter-rouge">docker-compose up -d</code> - Inicia todos los contenedores especificados en el archivo <em>docker-compose.yml</em> del directorio actual. Necesitas tener instalado, además de Docker, el programa <em>docker-compose</em>.</li> <li><code class="language-plaintext highlighter-rouge">docker-compose down</code> - Detiene todos los contenedores especificados en el archivo <em>docker-compose.yml</em> del directorio actual.</li> </ul> <h2 id="a23-persistencia-de-datos"> <a href="#a23-persistencia-de-datos" class="anchor-heading" aria-labelledby="a23-persistencia-de-datos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A2.3. Persistencia de datos </h2> <p>Cualquier cosa que guardes en un contenedor de Docker se perderá cuando el contenedor se detenga. Por ejemplo, si estás haciendo una aplicación web que usa una base de datos MySQL, y tu servidor MySQL está en un contenedor Docker, toda la información de esa base de datos se perderá cada vez que destruyas el contenedor.</p> <p>Es posible evitar eso usando la persistencia de datos.</p> <p>XXX completar esta sección XXX</p> <h2 id="a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos"> <a href="#a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos" class="anchor-heading" aria-labelledby="a24-un-ejemplo-montando-un-servidor-web-con-persistencia-de-datos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A2.4. Un ejemplo: montando un servidor web con persistencia de datos </h2> <p>En esta sección vamos a mostrar cómo montar un servidor web con imágenes Docker y levantarlo o apagarlo con docker-compose.</p> <p>Usaremos las imágenes de Bitnami, un desarrollador español recientemente adquirido por VMWare. Sus imágenes son fáciles de configurar (dentro de lo que cabe) y bastante confiables.</p> <p>Vamos a poner en marcha <strong>cuatro contenedores</strong> simultáneamente:</p> <ol> <li><strong>Servidor Apache</strong> (imagen bitnami/apache)</li> <li><strong>Intérprete PHP</strong> (image bitnami/phpfpm)</li> <li><strong>Servidor MariaDB</strong> (imagen bitnami/mariadb)</li> <li><strong>PHPMyAdmin</strong> (imagen bitnami/phpmyadmin)</li> </ol> <p>Además, necesitamos que los datos de MariaDB sean persistentes, es decir, que no se pierdan cuando detengamos los contenedores.</p> <p>Si buscamos en DockerHub cada una de esas imágenes, encontraremos un archivo de configuración <em>docker-compose.yml</em> para cada una de ellas.</p> <p>Tenemos que construir un <strong><em>docker-compose.yml</em></strong> único combinando todos los archivos de configuración de todas las imágenes y ubicarlo en el directorio raíz de nuestro proyecto. Nos debe quedar algo así:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">php</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">bitnami/php-fpm:latest</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9000:9000</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.:/app</span>
  <span class="na">apache</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">bitnami/apache:latest</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">80:8080</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./apache-vhost/myapp.conf:/vhosts/myapp.conf:ro</span>
      <span class="pi">-</span> <span class="s">.:/app</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">php</span>
  <span class="na">mariadb</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">docker.io/bitnami/mariadb:10.6</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MARIADB_ROOT_PASSWORD=bitnami</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">mariadb_data:/bitnami'</span>
  <span class="na">phpmyadmin</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">docker.io/bitnami/phpmyadmin:5</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">8000:8080'</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">mariadb</span>

<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">mariadb_data</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span>
</code></pre></div></div> <p>Además, necesitamos crear un subdirectorio llamado <strong><em>apache-vhost</em></strong> y, dentro de él, colocar un archivo <em>myapp.conf</em> con este contenido:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
&lt;VirtualHost *:8080&gt;
  DocumentRoot "/app"
  ProxyPassMatch ^/(.*\.php(/.*)?)$ fcgi://php:9000/app/$1
  &lt;Directory "/app"&gt;
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
    DirectoryIndex index.php
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre></div></div> <p>Esto hace que todas las peticiones de scripts PHP que lleguen al servidor se pasen automáticamente al contenedor de PHP para que las interprete.</p> <p>Ya podemos <strong>poner en marcha los cuatro contenedores</strong> tecleando (en el directorio de trabajo):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-compose up -d
</code></pre></div></div> <p>Para <strong>detener los contenedores</strong>, teclearemos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose down
</code></pre></div></div> <p>El servidor estará respondiendo en la dirección http://localhost. Es muy importante que no tengas otro proceso usando el puerto 80 (el típico de http), o de lo contrario el contenedor de Apache no arrancará. Esto puede suceder si tienes un Apache nativo corriendo en tu máquina.</p> <p>En cuanto a PHPMyAdmin, lo encontrarás eh http://localhost:8000.</p> <p>Esos puertos (el 80 y el 8000) se pueden cambiar trasteando un poco con el archivo docker-compose.yml. Recuerda detener y volver a lanzar los contenedores cada vez que cambies la configuración.</p> <p>Por último, si necesitas instalar dependencias de PHP con <strong>composer</strong>, puedes hacerlo creando un archivo <em>composer.json</em> en el directorio raíz del proyecto y ejecutando <em>composer install</em> dentro del contenedor de PHP:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-compose exec php composer install
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
