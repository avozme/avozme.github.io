---
layout: page
title: 5.18 Ejemplo de aplicación desarrollada con Laravel
permalink: /laravel/ejemplo-aplicacion-con-laravel
nav_order: 16
has_children: false
parent: 5 Laravel
grand_parent: Desarrollo Web en Entorno Servidor
---

## 5.18. Un ejemplo de aplicación desarrollada con Laravel
{: .no_toc }

- TOC
{:toc}

Para finalizar esta introducción (sí, sí: aunque haya sido muy largo, no es más que una introducción) a Laravel, vamos a **desarrollar una pequeña aplicación web desde cero**.

Se tratará, en realidad, de un fragmento de otra aplicación más grande: una tienda online o tal vez un sistema de gestión de almacén. Da lo mismo. Nosotros vamos a desarrollar la parte de **mantenimiento de productos**.

Para ello, supondremos que en la base de datos existe una tabla llamada *products* con los campos *id, name, description* y *price*.

Vamos a construir el controlador, el modelo y las vistas necesarias para hacer el CRUD completo (create-read-update-delete) de esta tabla con Laravel, sin olvidarnos de las migraciones, los seeders y, por supuesto, el enrutador.

¿Estás preparado/a? Pues vamos allá.

### 5.18.1. Desplegar un Laravel limpio

### 5.18.2. Conectar al servidor

### 5.18.3. Crear las migraciones y los seeders

### 5.18.4. Crear el controlador y actualizar el enrutador

### 5.18.5. Crear el modelo

### 5.18.6. Crear las vistas

### 5.18.7. Código fuente completo

#### Migración (/database/migrations/xxxxxxxxcreate_products_table.php)

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateProductsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('products', function (Blueprint $table) {
            $table->id();
            $table->string('name', 100);
            $table->string('description', 500);
            $table->double('price', 5, 2);
            $table->string('image', 200);
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('products');
    }
}
```

#### Seeder (/database/seeders/ProductTableSeeder.php)

En este *seeder* vamos a cargar unos cuantos datos de prueba. Obviamente, puedes cambiarlos por los que tú quieras.

Recuerda que, para poder lanzar el seeder automáticamente con ```php artisan migrate:fresh --seed``` u otro comando similar, tienes que editar el archivo *DatabaseSeeder.php* y añadir el seeder de productos. Si no recuerdas cómo hacerlo, consulta la sección de este tema dedicada a las migraciones.

```php
<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use DB;

class ProductTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        DB::table('products')->insert([
            'name' => 'Papel higiénico',
            'description' => 'Papel higiénico extrasuave para glúteos sensibles',
            'price' => '1.35',
            'image' => 'papel-higienico.jpg'
        ]);
        DB::table('products')->insert([
            'name' => 'Lejía blanca 1L',
            'description' => 'Lejía pura capaz de traladrar las baldosas',
            'price' => '0.95',
            'image' => 'lejia.jpg'
        ]);
        DB::table('products')->insert([
            'name' => 'Detergente Ariel 1.5L',
            'description' => 'Detergente líquido para lavadoras',
            'price' => '4.90',
            'image' => 'detergente.jpg'
        ]);
        DB::table('products')->insert([
            'name' => 'Gel Hidroalcohólico 350ml',
            'description' => 'Gel hidroalcólico sin perfume, 70% de alcohol',
            'price' => '3.50',
            'image' => 'gel-hidroalcoholico.jpg'
        ]);
        DB::table('products')->insert([
            'name' => 'Gel de baño con avena - 750 ml',
            'description' => 'Gel de baño con aceites vegetales, hipoalergénico',
            'price' => '1.50',
            'image' => 'gel-bano.jpg'
        ]);
    }
}
```


#### Enrutador (/routes/web.php)

Hay que añadir esta línea al enrutador:

```php
<?php
Route::resource('products', 'ProductController');
```

#### Controlador (/hpp/Http/Controllers/ProductController.php)

```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Product;

class ProductController extends Controller
{
    public function index() {
        $productList = Product::all();
        return view('product.all', ['productList'=>$productList]);
    }

    public function show($id) {
        $p = Product::find($id);
        $data['product'] = $p;
        return view('product.show', $data);
    }

    public function create() {
        return view('product.form');
    }

    public function store(Request $r) {
        $p = new Product();
        $p->name = $r->name;
        $p->description = $r->description;
        $p->price = $r->price;
        $p->image = $r->image;
        $p->save();
        return redirect()->route('product.index');
    }

    public function edit($id) {
        $product = Product::find($id);
        return view('product.form', array('product' => $product));
    }

    public function update($id, Request $r) {
        $p = Product::find($id);
        $p->name = $r->name;
        $p->description = $r->description;
        $p->price = $r->price;
        $p->image = $r->image;
        $p->save();
        return redirect()->route('product.index');
    }

    public function destroy($id) {
        $p = Product::find($id);
        $p->delete();
        return redirect()->route('product.index');
    }
}
```

#### Modelo (app/models/product.php)

El modelo no hay que tocarlo. Lo podemos dejar como lo haya generado Artisan.

#### Vista views/layouts/master.blade.php

Esta vista es el *master layout* o plantilla principal

```html
  <html>
     <head>
        <title>@yield('title')</title>
     </head>
     <body>
        @section('sidebar')
            Este es mi master sidebar.
        @show

        <div class="container">
            @yield('content')
        </div>
     </body>
  </html>
```

#### Vista views/products/all.blade.php

Esta es la vista para mostrar todos los productos.

```html
@extends("layouts.master")

@section("title", "Administración de productos")

@section("header", "Administración de productos")

@section("content")
    <a href="{{ route('product.create') }}">Nuevo</a>
    <table border='1'>
    @foreach ($productList as $product)
        <tr>
            <td>{{$product->name}}</td>
            <td>{{$product->description}}</td>
            <td>{{$product->price}}</td>
            <td>
                <a href="{{route('product.edit', $product->id)}}">Modificar</a></td>
            <td>
                <form action = "{{route('product.destroy', $product->id)}}" method="POST">
                    @csrf
                    @method("DELETE")
                    <input type="submit" value="Borrar">
                </form>
            </td>
        <br>
    @endforeach
@endsection
```

#### Vista views/products/form.blade.php

Esta es la vista para creación/modificación de productos.

```html
@extends("layouts.master")

@section("title", "Inserción de productos")

@section("header", "Inserción de productos")

@section("content")
    @isset($product)
        <form action="{{ route('product.update', ['product' => $product->id]) }}" method="POST">
        @method("PUT")
    @else
        <form action="{{ route('product.store') }}" method="POST">
    @endisset
        @csrf
        Nombre del producto:<input type="text" name="name" value="{{$product->name ?? '' }}"><br>
        Descripción:<input type="text" name="description" value="{{$product->description ?? '' }}"><br>
        Precio:<input type="text" name="price" value="{{$product->price ?? '' }}"><br>
        Imagen:<input type="text" name="image" value="{{$product->image ?? '' }}"><br>
        <input type="submit">
        </form>
@endsection
```

### 5.18.8. ¿Y ahora qué?

El código anterior solo es un pequeño ejemplo y se puede mejorar de muchas maneras, por supuesto. Estas son algunas mejoras evidentes:

* XXX Falta la vista product.show
* Se puede simplificar el métodos *store()* del controlador haciendo una asignación masiva. Bastaría con indicar en el modelo que todos los campos de la tabla son *fillables* para poder hacer esto en el método *store()* del controlador: ```$p = new Producut($r->all())```
* Se puede alterar el aspecto visual de la aplicación trabajando el *master layout*, sin que haya que tocar las vistas.
* Se puede continuar construyendo la aplicación, añadiendo más tablas con su correspondientes controladores, modelos y vistas. Llegará un momento en el que tendremos que crear las relaciones entre las tablas en los modelos, como explicamos en el apartado dedicado a Eloquent.
* Otro paso lógico, común a muchas aplicaciones web, es añadir un sistema de autenticación con **Laravel Breeze**.

Utiliza este código fuente como punto de partida para tus propios desarrollos con Laravel. Cuando hayas cogido un poco de práctica, verás que resulta mucho más rápido montar una aplicación web convencional con Laravel que hacerlo con PHP clásico.