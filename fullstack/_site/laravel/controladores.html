<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>2.8 Controladores - DESARROLLO WEB FULL STACK</title> <link rel="shortcut icon" href="/docs/fullstack/_site/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/fullstack/_site/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/docs/fullstack/_site/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/fullstack/_site/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>2.8 Controladores | DESARROLLO WEB FULL STACK</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="2.8 Controladores" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo optativo de “Desarrollo web full stack”, de 2º curso del Ciclo Formativo de Grado Superior de Desarrollo de Aplicaciones Web/Multiplataforma impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo optativo de “Desarrollo web full stack”, de 2º curso del Ciclo Formativo de Grado Superior de Desarrollo de Aplicaciones Web/Multiplataforma impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="https://iescelia.org/docs/fullstack/_site/laravel/controladores.html" /> <meta property="og:url" content="https://iescelia.org/docs/fullstack/_site/laravel/controladores.html" /> <meta property="og:site_name" content="DESARROLLO WEB FULL STACK" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="2.8 Controladores" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Apuntes del módulo optativo de “Desarrollo web full stack”, de 2º curso del Ciclo Formativo de Grado Superior de Desarrollo de Aplicaciones Web/Multiplataforma impartido en el IES Celia Viñas de Almería (España)","headline":"2.8 Controladores","url":"https://iescelia.org/docs/fullstack/_site/laravel/controladores.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://iescelia.org/docs/fullstack/_site/" class="site-title lh-tight"> DESARROLLO WEB FULL STACK </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/fullstack/_site/" class="nav-list-link">Desarrollo web full stack</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/fullstack/_site/php/" class="nav-list-link">1 Programación web con PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/frontend-backend-fullstack.html" class="nav-list-link">1.1 Frontend vs backend vs full stack</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/caja-de-herramientas.html" class="nav-list-link">1.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/sintaxis-de-php.html" class="nav-list-link">1.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/interaccion-con-mysql.html" class="nav-list-link">1.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/depuracion-php-xdebug.html" class="nav-list-link">1.5 Depurando el código PHP con xdebug</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/cookies-y-sesiones.html" class="nav-list-link">1.6 Cookies y variables de sesión</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/mvc/" class="nav-list-link">1.7 Arquitectura MVC</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/ejemplos-resueltos.html" class="nav-list-link">1.8 Ejemplos resueltos</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/php/ejercicios-propuestos.html" class="nav-list-link">1.9 Prácticas</a> </li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://iescelia.org/docs/fullstack/_site/laravel/" class="nav-list-link">2 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/caracteristicas.html" class="nav-list-link">2.1 Características de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/instalacion.html" class="nav-list-link">2.2 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/configuracion.html" class="nav-list-link">2.3 Configuración de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/artisan.html" class="nav-list-link">2.4 Artisan</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/hola-mundo-con-laravel.html" class="nav-list-link">2.5 Hola mundo</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/enrutamiento.html" class="nav-list-link">2.6 Enrutamiento</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/vistas-blade.html" class="nav-list-link">2.7 Vistas y plantillas con Blade</a> </li><li class="nav-list-item active"> <a href="https://iescelia.org/docs/fullstack/_site/laravel/controladores.html" class="nav-list-link active">2.8 Controladores</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/migraciones.html" class="nav-list-link">2.9 Migraciones</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/eloquent.html" class="nav-list-link">2.10 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/querybuilder.html" class="nav-list-link">2.11 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/sesiones.html" class="nav-list-link">2.12 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/helpers.html" class="nav-list-link">2.13 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/flujo-de-trabajo-con-laravel.html" class="nav-list-link">2.14 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/aspectos-avanzados.html" class="nav-list-link">2.15 Aspectos avanzados de Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/crud-con-laravel.html" class="nav-list-link">2.16 CRUD desarrollado con Laravel</a> </li><li class="nav-list-item "> <a href="https://iescelia.org/docs/fullstack/_site/laravel/practicas.html" class="nav-list-link">2.17 Prácticas</a> </li></ul></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/api-rest/" class="nav-list-link">3 Desarrollo de un API REST</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/vue-js/" class="nav-list-link">4 Vue.js</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/inertia/" class="nav-list-link">5 Intertia.js</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/scv-git/" class="nav-list-link">Apéndice 1. Sistemas de control de versiones. Git</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/docker/" class="nav-list-link">Apéndice 2. Virtualización con Docker</a></li><li class="nav-list-item "><a href="https://iescelia.org/docs/fullstack/_site/openstack/" class="nav-list-link">Apéndice 3. Despliegue con Openstack</a></li></ul></li><li class="nav-list-item"><a href="https://iescelia.org/docs/fullstack/_site/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DESARROLLO WEB FULL STACK" aria-label="Search DESARROLLO WEB FULL STACK" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://iescelia.org/docs/fullstack/_site/">Desarrollo web full stack</a></li> <li class="breadcrumb-nav-list-item"><a href="https://iescelia.org/docs/fullstack/_site/laravel/">2 Laravel</a></li> <li class="breadcrumb-nav-list-item"><span>2.8 Controladores</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 class="no_toc" id="28-controladores"> <a href="#28-controladores" class="anchor-heading" aria-labelledby="28-controladores"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.8. Controladores </h2> <ul id="markdown-toc"> <li><a href="#281-cuatro-cosas-importantes-sobre-los-controladores-en-laravel" id="markdown-toc-281-cuatro-cosas-importantes-sobre-los-controladores-en-laravel">2.8.1. Cuatro cosas importantes sobre los controladores en Laravel</a></li> <li><a href="#282-tres-formas-de-crear-un-controlador" id="markdown-toc-282-tres-formas-de-crear-un-controlador">2.8.2. Tres formas de crear un controlador</a></li> <li><a href="#283-buenas-prácticas-de-programación-de-controladores" id="markdown-toc-283-buenas-prácticas-de-programación-de-controladores">2.8.3. Buenas prácticas de programación de controladores</a></li> </ul> <p>Los <strong>controladores</strong> son un elemento clave de la <strong>arquitectura MVC</strong>. En Laravel, los controladores funcionan exactamente igual que en las aplicaciones MVC hechas con PHP clásico.</p> <p>Es decir: son los puntos de entrada a la aplicación desde el enrutador.</p> <p>Los controladores deberían permanecer lo más sencillos posible: nada de accesos a la base de datos ni de generación de HTML. Esas acciones se derivarán a los modelos y las vistas. El controlador es un organizador del flujo de la aplicación: decide qué componente tiene que trabajar y el orden en el que lo debe hacer.</p> <p>En esta sección, vamos a aprender a construir controladores con Laravel. Vas a ver que es algo extremadamente sencillo.</p> <h3 id="281-cuatro-cosas-importantes-sobre-los-controladores-en-laravel"> <a href="#281-cuatro-cosas-importantes-sobre-los-controladores-en-laravel" class="anchor-heading" aria-labelledby="281-cuatro-cosas-importantes-sobre-los-controladores-en-laravel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.8.1. Cuatro cosas importantes sobre los controladores en Laravel </h3> <ol> <li> <p>Los <strong>controladores</strong> en Laravel siempre <strong>heredan de la clase <em>Controller</em></strong> o de una subclase de <em>Controller</em>.</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MiControlador</span> <span class="kd">extends</span> <span class="nc">Controller</span> <span class="p">{</span>
   <span class="mf">...</span>
<span class="p">}</span>
</code></pre></div> </div> </li> <li> <p>Su nombre debería escribirse en singular, CamelCase y terminando en la palabra Controller. Por ejemplo: <em>UserController</em>, <em>LoginController</em>, <em>ArticleController</em>…</p> </li> <li> <p><strong>Cada método del controlador debe terminar en un <em>return</em></strong>. Lo que el método devuelva será convertido automáticamente en una <em>HTTP response 200</em>, es decir, en una respuesta válida http, excepto si es un array, en cuyo caso Laravel lo convertirá automáticamente en JSON (perfecto para responder a peticiones Ajax, como veremos más adelante).</p> </li> <li> <p>Si lo necesitas, puedes actuar sobre la <em>HTTP response</em> devolviendo algo como esto:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">return</span> <span class="nf">response</span><span class="p">(</span><span class="s1">'contenido'</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
         <span class="o">-&gt;</span><span class="nb">header</span><span class="p">(</span><span class="s1">'mi-cabecera'</span><span class="p">,</span> <span class="s1">'contenido'</span><span class="p">)</span>
         <span class="o">-&gt;</span><span class="nb">header</span><span class="p">(</span><span class="s1">'otra-cabecera'</span><span class="p">,</span> <span class="s1">'más-contenido'</span><span class="p">)</span>
         <span class="o">-&gt;</span><span class="nf">cookie</span><span class="p">(</span><span class="s1">'mi-cookie'</span><span class="p">,</span> <span class="s1">'valor'</span><span class="p">);</span>
         <span class="p">(</span><span class="n">etc</span><span class="p">)</span>
</code></pre></div> </div> <p>(Pero no nos engañemos: no lo necesitarás hacer demasiado a menudo).</p> </li> </ol> <h3 id="282-tres-formas-de-crear-un-controlador"> <a href="#282-tres-formas-de-crear-un-controlador" class="anchor-heading" aria-labelledby="282-tres-formas-de-crear-un-controlador"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.8.2. Tres formas de crear un controlador </h3> <p>Los controladores se pueden crear a mano: vas al directorio <em>/app/http/controllers</em>, creas allí un archivo vacío y empiezas a escribir código como una fiera.</p> <p>Pero nadie lo hace así porque <strong>Artisan</strong> ya crea el esqueleto del archivo por ti. Así que es mejor que vayas a lo práctico: abre una consola en tu servidor web y ponte a escribir.</p> <p><strong>Forma 1. Crear un controlador vacío.</strong></p> <p>Por ejemplo, para crear un controlador para la tabla de usuarios:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $ php artisan make:controller UserController
</code></pre></div></div> <p><strong>Forma 2. Crear un controlador de tipo resource.</strong></p> <p>Estos controladores se generan automáticamente con un andamiaje para construir recursos <strong>REST</strong>. Es decir, la clase ya llevará incorporados los métodos <em>index(), create(), store(), show(), edit(), update()</em> y <em>destroy()</em> del estándar REST.</p> <p>(Si no sabes de qué estamos hablando, revisa la sección que dedicamos al enrutamiento en Laravel)</p> <p>Para crear un controlador RESTful:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $ php artisan make:controller UserController --resource
</code></pre></div></div> <p>No te olvides de añadir al enrutador (<em>/routes/web.php</em>) las rutas REST para este tipo controlador. Te recuerdo que se pueden resumir las siete rutas en esta sola entrada del enrutador:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Route::resource('nombreRecurso', 'controlador');
</code></pre></div></div> <p>En nuestro ejemplo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Route::resource('usuarios', 'UserController');
</code></pre></div></div> <p><strong>Forma 3. Crear un controlador tipo API.</strong></p> <p>Una <strong>API</strong> (<em>Application Programming Interface</em>) es un interfaz entre programas. Es decir, es la forma en la que unos programas interaccionan con otros.</p> <p>Algunas aplicaciones web se diseñan para que otros programas las utilicen, no para que las utilicen seres humanos. En estos casos, el interfaz de usuario no existe (o es mínimo) y lo importante es el API. Y los métodos del controlador no devuelven vistas, sino datos formateados en JSON.</p> <p>Se puede construir con Laravel un controlador tipo API de forma muy simple, porque es parecido a un <em>resource</em>, pero sin <em>create()</em> ni <em>edit()</em>, porque una API no necesita mostrar los formularios de inserción/modificación.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $ php artisan make:controller UserController --api
</code></pre></div></div> <p>De nuevo, no te olvides de las entradas en el enrutador. Puedes englobarlas todas en una sola entrada con este aspecto:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Route::apiResource('usuarios', 'UserController');
</code></pre></div></div> <h3 id="283-buenas-prácticas-de-programación-de-controladores"> <a href="#283-buenas-prácticas-de-programación-de-controladores" class="anchor-heading" aria-labelledby="283-buenas-prácticas-de-programación-de-controladores"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.8.3. Buenas prácticas de programación de controladores </h3> <ol> <li> <p>Usa <em>namespacings</em> en el archivo de rutas para referirte a los controladores.</p> <p><strong><em>/routes/web.php</em></strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">App\Htpp\Controllers\UserController</span><span class="p">;</span>
</code></pre></div> </div> <p>Y también usa <em>namespacing</em> en los controladores.</p> <p><strong><em>/app/Http/controllers/MyController.php</em></strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">App\Http\Controllers</span><span class="p">;</span>
</code></pre></div> </div> </li> <li> <p>Si el método del controlador recibe datos, recupéralos así:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Illuminate\Http\Request</span><span class="p">;</span>
<span class="mf">...</span>
<span class="k">public</span> <span class="k">function</span> <span class="n">store</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span> <span class="mf">...</span> <span class="p">}</span>
</code></pre></div> </div> </li> <li> <p>Usa nombres estándar para los métodos del controlador: <em>index(), store(), edit()</em>, etc. Sobre todo si estás construyendo un API estándar (ver tema siguiente).</p> </li> </ol> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
