---
layout: page
title: 2.17 Prácticas
permalink: /laravel/practicas.html
nav_order: 17
has_children: false
parent: 2 Laravel
grand_parent: Desarrollo web full stack
---

## 2.17. Prácticas
{: .no_toc }

En esta colección de actividades prácticas vamos a montar, poco a poco, una pequeña aplicación web que funcionará en el backend mediante generación de vistas.

La aplicación será un fragmento de un **blog**, es decir, permitirá publicar artículos y mostrarlos. Al finalizar, habrás creado una aplicación sencilla pero funcional con un potente y seguro sistema de autenticación integrado.

- TOC
{:toc}

### Actividad 1. Preparar el entorno

* **Objetivo**: Familiarizarse con Laravel y preparar la aplicación.
* **Tareas**:
    1. [Instala Laravel](../laravel/instalacion.html#22-instalaci%C3%B3n-de-laravel) (con Composer o Sail).
    2. [Configura el archivo .env](../laravel/configuracion.html#233-variables-de-entorno-el-archivo-env) con datos de tu base de datos. Obviamente, tendrás que haber creado la base de datos antes.

        Trabajaremos con estas **tablas en la base de datos** (usa los tipos de datos que te parezcan más razonables para cada campo):
        * *Tabla users*: id, username, email, password, role
        * *Tabla articles*: id, title, body, date, user_id

    3. Lanza el servidor y comprueba que Laravel responde.
    4. [Explora la estructura de directorios](../laravel/configuracion.html#231-estructura-de-directorios) (app, routes, resources/views, public, etc.).
* **Resultado**: Instalación limpia de Laravel funcionando y lista para desarrollar sobre ella.

### Actividad 2: Primer “Hola Mundo”
* **Objetivo**: Crear rutas, controladores y vistas básicas con Blade.
* **Tareas**:
    1. [Crea ruta simple en routes/web.php](../laravel/hola-mundo-con-laravel.html#soluci%C3%B3n-1-saludar-en-el-enrutador) que devuelva un mensaje “Hola, mundo”.
    2. [Crea un controlador HolaController](../laravel/hola-mundo-con-laravel.html#soluci%C3%B3n-2-saludar-en-un-controlador) con métodos *index()* y *show($nombre)* que hagan el saludo desde el propio controlador. El método *show($nombre)* debe incluir en el saludo el nombre de la persona que recibe como parámetro.
    3. [Crea una vista Blade](../laravel/hola-mundo-con-laravel.html#soluci%C3%B3n-3-saludar-en-una-vista) (hola.blade.php) para mostrar los saludos.
    4. Prueba la URL *http://servidor/hola* en el navegador con parámetro y sin parámetro. Asegúrate que funciona según lo esperado en ambos casos.
* **Resultado**: Construcción del primer controlador y vista funcional con Blade, con paso de parámetros en la URL.

### Actividad 3: Plantillas y Blade
* **Objetivo**: Aprender el uso de layouts, secciones y condicionales en Blade.
* **Tareas**:
    1. Crea una nueva entrada en el enrutador y el controlador anteriores que renderice una vista llamada *articlesList*. [Esta vista debe recibir tres datos](../laravel/vistas-blade.html#276-condiciones-en-las-vistas): el id del usuario autor de los artículos, el nombre de ese usuario y un array con los títulos de los artículos. Puedes asignar, de momento, valores fijos a esas variables antes de pasárselas a la vista.
    2. [Crea el master layout (layouts/master.blade.php)](../laravel/vistas-blade.html#272-master-layout) con secciones title, sidebar y content.
    3. [Crea vista heredada page.blade.php](../laravel/vistas-blade.html#273-vistas-que-heredan-del-master-layout) que extienda el master layout. 
    
        La vista que has creado recibirá tres datos: *$id* (el id de un autor), *$username* (el nombre del autor) y *$articles* (un array con los títulos de los artículos que ha escrito ese autor). Muestra el *$id* y el *$username* en una salida HTML (la lista de títulos la usaremos enseguida).

    4. [Crea salida dinámica y condicional (@if, @else)](../laravel/vistas-blade.html#276-condiciones-en-las-vistas). Modifica la vista para que la lista de títulos solo se muestre si contiene datos. Si la lista está vacía, muestra el texto "No existen artículos".
    5. [Usa bucles (@foreach)](../laravel/vistas-blade.html#277-bucles-en-las-vistas). Recorre el array con los títulos de los artículos y muéstralos en la salida HTML.
* **Resultado**: Construcción de vistas con Blade consistentes, reutilizables y dinámicas.

### Actividad 4: Migraciones y Eloquent
* **Objetivo**: Crear la base de datos, las migraciones y los modelos, así como algunas consultas de prueba.
* **Tareas**:
    1. [Crea las migraciones](../laravel/vistas-blade.html#277-bucles-en-las-vistas) para las tablas *users* y *articles*.
    2. [Crea seeders para ambas tablas](../laravel/vistas-blade.html#277-bucles-en-las-vistas). Rellena las tablas con unos cuantos datos ficticios pero realistas generados con *Faker*.
    3. [Crea los modelos](../laravel/eloquent.html#2102-c%C3%B3mo-puedo-usar-eloquent-en-mi-aplicaci%C3%B3n) User y Article.
    4. Ejecutar migraciones y los seeders..
    5. [Haz consultas básicas con Eloquent](../laravel/eloquent.html#2104-consultas-con-eloquent) (all(), find(), where(), save()). Para comprobar que funcionan, puedes crear una ruta y un método en el controlador desde el que lanzar las consultas y mostrar los resultados.
* **Resultado**: BD preparada y Eloquent funcionando.

### Actividad 5: Mostrar todos los artículos
* **Objetivo**: Crear una vista con todos los artículos
* **Tareas**:
    1. Crea la ruta *articles* en el enrutador (*routes/web.php*). Que ejecute el método *index()* del controlador de artículos.
    2. Modifica el controlador de artículos para que el método *index()* recupere todos los artículos de la base de datos y se los pase a la vista *articles/index.blade.php*
    3. Crea la vista *articles/index.blade.php*, que recibirá la lista de artículos y los mostrará. Solo debe aparecer el título del artículo y la fecha.
* **Resultado**: Vista principal de artículos preparada

### Actividad 6: Mostrar un artículo

* **Objetivo**: Mostrar la información completa de un artículo al hacer clic en su título desde la lista general.
* **Tareas:**
    1. Crea ruta *articles/{id}* en *routes/web.php*. Ponle un nombre: *articles.show*.
    2. Añade el método *show($id)* al controlador de artículos. Este método debe buscar el artículo con Eloquent y lo pasarlo a la vista *articles/show.blade.php* que vamos a crear enseguida.
    3. Crea vista *articles/show.blade.php* que muestre título, contenido, autor y fecha del artículo que se le ha pasado desde el controlador.
    4. En *articles/index.blade.php*, convierte el título de cada artículo en enlace a la ruta de que has creado en este ejercicio. Usa para ello ```route('articles.show', $article->id)```.

* **Resultado**: Navegación completa entre el listado de artículos y la vista de detalle de cada uno.

### Actividad 7: Alta de nuevos artículos

* **Objetivo**: Crear nuevos artículos desde la aplicación, con mensajes de realimentación al usuario.
* **Tareas**:
    1. Crea las rutas *articles/create* (GET) y *articles* (POST) en *routes/web.php*. Nómbralas *articles.create* y *articles.store*.
    2. Añade al controlador de artículos dos métodos:
        * *create()* para mostrar el formulario (vista *articles/create.blade.php*).
        * *store()* para validar los datos del formulario (*title, body, date*), guardar el artículo en la BD y redirigir a la lista de artículos con un mensaje de éxito o de error. Por el momento, que todos los artículos se guarden con el *user_id = 1*.
    3. Crea vista *articles/create.blade.php* con un formulario que incluya los campos de título, contenido y fecha. Mostrar posibles errores de validación.
    4. En *articles/index.blade.php*, añade un enlace “Nuevo artículo” que lleve al formulario de creación.
* **Resultado**: La aplicación permite ahora añadir artículos nuevos a la base de datos.

### Actividad 8: Borrado de artículos

* **Objetivo**: Añadir la posibilidad de borrar artículos, con confirmación y mensaje de éxito o error.
* **Tareas**:
    1. Añade la ruta DELETE */articles/{id}* en *routes/web.php* con el nombre *articles.destroy*.
    2. En el controlador de artículos, crea método *destroy($id)* que busque el artículo, lo elimine con Eloquent y redirija a la lista de artículos con un mensaje de confirmación o de error en el borrado.
    3. En *articles/index.blade.php*, añadir en cada fila (cada artículo) un enlace o botón “Eliminar” que envíe un formulario con el method="POST", @method('DELETE') y @csrf, para que el enrutador capture esa ruta.
    4. Mostrar el mensaje en la vista de lista ("borrado con éxito" o "error al borrar") tras el borrado.
* **Resultado**: La aplicación puede ahora eliminar artículos.

### Actividad 9: Autenticación con Breeze

* **Objetivo**: Crear el login/logout y el alta de usuarios.
* **Tareas**:
    1. [Instala Laravel Breeze](../laravel/sesiones.html#2124-laravel-breeze) para añadir un sistema de autenticación a tu aplicación.
    2. Prueba el registro de usuarios y el login/logout.
    3. [Usa @auth y @guest en las vistas](../laravel/sesiones.html#2124-laravel-breeze) que tienes construidas hasta ahora para mostrar  contenido condicional. Los usuarios autenticados verán su nombre y los enlaces para "Añadir" y "Borrar" artículos. Los usuarios no autenticados no verán esos enlaces.
    4. [Protege el controlador de artículos](../laravel/sesiones.html#2126-autenticaci%C3%B3n-y-middlewares-c%C3%B3mo-proteger-los-controladores) para que solo los usuarios autenticados puedan acceder a los métodos que alteran la información (como *store()* y *destroy()*). Comprueba que funciona.
* **Resultado**: Sistema de login/registro funcional integrado en la aplicación.

### Actividad 10: Pulido final
* **Objetivo**: Consolidar la aplicación y probar el flujo completo.
* **Tareas**:
    1. Modifica la aplicación para que, al crear un artículo, se guarde el id del usuario autenticado (hasta ahora, todos los artículos se estaban guardando con *user_id = 1*).
    2. Revisa todos los formularios, mensajes al usuario y rutas.
    3. Cambia la página de inicio (dashboard) para que, tras el login, vayamos al listado de artículos. Solo deben aparecer los artículos del usuario autenticado.
    4. Añade la posibilidad de que un usuario autenticado modifique sus artículos. Intenta reutilizar para ello la vista de añadir nuevos artículos en lugar de crear una nueva.
    5. [Añade un poco de CSS](../laravel/vistas-blade.html#2712-a%C3%B1adir-css-y-javascript-a-nuestras-vistas) para hacer más atractivas las vistas.
    
* **Resultado**: Aplicación funcional de ejemplo, lista para extender con nuevas funcionalidades.
